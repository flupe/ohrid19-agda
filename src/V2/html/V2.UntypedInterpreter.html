<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>V2.UntypedInterpreter</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Comment">-- Untyped interpreter for the WHILE language.</a>
<a id="48" class="Comment">--</a>
<a id="51" class="Comment">-- * Runs directly on the unchecked abstract syntax tree.</a>
<a id="109" class="Comment">-- * May fail due to scope and other runtime errors.</a>
<a id="162" class="Comment">-- * while loops may not terminate.</a>

<a id="199" class="Keyword">module</a> <a id="206" href="V2.UntypedInterpreter.html" class="Module">V2.UntypedInterpreter</a> <a id="228" class="Keyword">where</a>

<a id="235" class="Keyword">open</a> <a id="240" class="Keyword">import</a> <a id="247" href="Library.html" class="Module">Library</a>
<a id="255" class="Keyword">open</a> <a id="260" class="Keyword">import</a> <a id="267" href="V2.AST.html" class="Module">V2.AST</a>

<a id="275" class="Comment">-- Untyped values.</a>

<a id="295" class="Keyword">data</a> <a id="Val"></a><a id="300" href="V2.UntypedInterpreter.html#300" class="Datatype">Val</a> <a id="304" class="Symbol">:</a> <a id="306" class="PrimitiveType">Set</a> <a id="310" class="Keyword">where</a>
  <a id="Val.intV"></a><a id="318" href="V2.UntypedInterpreter.html#318" class="InductiveConstructor">intV</a>  <a id="324" class="Symbol">:</a> <a id="326" href="Agda.Builtin.Int.html#219" class="Datatype">ℤ</a>       <a id="334" class="Symbol">→</a> <a id="336" href="V2.UntypedInterpreter.html#300" class="Datatype">Val</a>
  <a id="Val.boolV"></a><a id="342" href="V2.UntypedInterpreter.html#342" class="InductiveConstructor">boolV</a> <a id="348" class="Symbol">:</a> <a id="350" href="V2.AST.html#474" class="Datatype">Boolean</a> <a id="358" class="Symbol">→</a> <a id="360" href="V2.UntypedInterpreter.html#300" class="Datatype">Val</a>

<a id="365" class="Keyword">instance</a>
  <a id="PrintVal"></a><a id="376" href="V2.UntypedInterpreter.html#376" class="Function">PrintVal</a> <a id="385" class="Symbol">:</a> <a id="387" href="Library.Print.html#196" class="Record">Print</a> <a id="393" href="V2.UntypedInterpreter.html#300" class="Datatype">Val</a>
  <a id="399" href="Library.Print.html#244" class="Field">print</a> <a id="405" class="Symbol">{{</a><a id="407" href="V2.UntypedInterpreter.html#376" class="Function">PrintVal</a><a id="415" class="Symbol">}}</a> <a id="418" class="Symbol">=</a> <a id="420" class="Symbol">λ</a> <a id="422" class="Keyword">where</a>
    <a id="432" class="Symbol">(</a><a id="433" href="V2.UntypedInterpreter.html#318" class="InductiveConstructor">intV</a> <a id="438" href="V2.UntypedInterpreter.html#438" class="Bound">i</a><a id="439" class="Symbol">)</a>  <a id="442" class="Symbol">→</a> <a id="444" href="Library.Print.html#244" class="Field">print</a> <a id="450" href="V2.UntypedInterpreter.html#438" class="Bound">i</a>
    <a id="456" class="Symbol">(</a><a id="457" href="V2.UntypedInterpreter.html#342" class="InductiveConstructor">boolV</a> <a id="463" href="V2.UntypedInterpreter.html#463" class="Bound">b</a><a id="464" class="Symbol">)</a> <a id="466" class="Symbol">→</a> <a id="468" href="Library.Print.html#244" class="Field">print</a> <a id="474" href="V2.UntypedInterpreter.html#463" class="Bound">b</a>

<a id="477" class="Comment">-- Poor man&#39;s environments (association list).</a>

<a id="Env"></a><a id="525" href="V2.UntypedInterpreter.html#525" class="Function">Env</a> <a id="529" class="Symbol">:</a> <a id="531" class="PrimitiveType">Set</a>
<a id="535" href="V2.UntypedInterpreter.html#525" class="Function">Env</a> <a id="539" class="Symbol">=</a> <a id="541" href="Agda.Builtin.List.html#121" class="Datatype">List</a> <a id="546" class="Symbol">(</a><a id="547" href="V2.AST.html#282" class="Datatype">Id</a> <a id="550" href="Data.Product.html#1162" class="Function Operator">×</a> <a id="552" href="V2.UntypedInterpreter.html#300" class="Datatype">Val</a><a id="555" class="Symbol">)</a>

<a id="558" class="Comment">-- Looking up the value bound to a variable in an environment.</a>

<a id="lookupId"></a><a id="622" href="V2.UntypedInterpreter.html#622" class="Function">lookupId</a> <a id="631" class="Symbol">:</a> <a id="633" href="V2.UntypedInterpreter.html#525" class="Function">Env</a> <a id="637" class="Symbol">→</a> <a id="639" href="V2.AST.html#282" class="Datatype">Id</a> <a id="642" class="Symbol">→</a> <a id="644" href="Data.Maybe.Base.html#795" class="Datatype">Maybe</a> <a id="650" href="V2.UntypedInterpreter.html#300" class="Datatype">Val</a>
<a id="654" href="V2.UntypedInterpreter.html#622" class="Function">lookupId</a> <a id="663" href="Agda.Builtin.List.html#158" class="InductiveConstructor">[]</a>             <a id="678" href="V2.UntypedInterpreter.html#678" class="Bound">y</a> <a id="680" class="Symbol">=</a> <a id="682" href="Data.Maybe.Base.html#859" class="InductiveConstructor">nothing</a>
<a id="690" href="V2.UntypedInterpreter.html#622" class="Function">lookupId</a> <a id="699" class="Symbol">((</a><a id="701" href="V2.UntypedInterpreter.html#701" class="Bound">x</a> <a id="703" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="705" href="V2.UntypedInterpreter.html#705" class="Bound">v</a><a id="706" class="Symbol">)</a> <a id="708" href="Agda.Builtin.List.html#173" class="InductiveConstructor Operator">∷</a> <a id="710" href="V2.UntypedInterpreter.html#710" class="Bound">xs</a><a id="712" class="Symbol">)</a> <a id="714" href="V2.UntypedInterpreter.html#714" class="Bound">y</a> <a id="716" class="Symbol">=</a>
  <a id="720" href="Data.Bool.Base.html#1312" class="Function Operator">if</a> <a id="723" href="V2.UntypedInterpreter.html#701" class="Bound">x</a> <a id="725" href="Library.Eq.html#688" class="Function Operator">==</a> <a id="728" href="V2.UntypedInterpreter.html#714" class="Bound">y</a>
  <a id="732" href="Data.Bool.Base.html#1312" class="Function Operator">then</a> <a id="737" href="Data.Maybe.Base.html#829" class="InductiveConstructor">just</a> <a id="742" href="V2.UntypedInterpreter.html#705" class="Bound">v</a>
  <a id="746" href="Data.Bool.Base.html#1312" class="Function Operator">else</a> <a id="751" href="V2.UntypedInterpreter.html#622" class="Function">lookupId</a> <a id="760" href="V2.UntypedInterpreter.html#710" class="Bound">xs</a> <a id="763" href="V2.UntypedInterpreter.html#714" class="Bound">y</a>

<a id="766" class="Comment">-- Adding or updating a binding in the environment.</a>

<a id="updateEnv"></a><a id="819" href="V2.UntypedInterpreter.html#819" class="Function">updateEnv</a> <a id="829" class="Symbol">:</a> <a id="831" href="V2.AST.html#282" class="Datatype">Id</a> <a id="834" class="Symbol">→</a> <a id="836" href="V2.UntypedInterpreter.html#300" class="Datatype">Val</a> <a id="840" class="Symbol">→</a> <a id="842" href="V2.UntypedInterpreter.html#525" class="Function">Env</a> <a id="846" class="Symbol">→</a> <a id="848" href="V2.UntypedInterpreter.html#525" class="Function">Env</a>
<a id="852" href="V2.UntypedInterpreter.html#819" class="Function">updateEnv</a> <a id="862" href="V2.UntypedInterpreter.html#862" class="Bound">x</a> <a id="864" href="V2.UntypedInterpreter.html#864" class="Bound">v</a> <a id="866" href="Agda.Builtin.List.html#158" class="InductiveConstructor">[]</a>            <a id="880" class="Symbol">=</a> <a id="882" class="Symbol">(</a><a id="883" href="V2.UntypedInterpreter.html#862" class="Bound">x</a> <a id="885" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="887" href="V2.UntypedInterpreter.html#864" class="Bound">v</a><a id="888" class="Symbol">)</a> <a id="890" href="Agda.Builtin.List.html#173" class="InductiveConstructor Operator">∷</a> <a id="892" href="Agda.Builtin.List.html#158" class="InductiveConstructor">[]</a>
<a id="895" href="V2.UntypedInterpreter.html#819" class="Function">updateEnv</a> <a id="905" href="V2.UntypedInterpreter.html#905" class="Bound">x</a> <a id="907" href="V2.UntypedInterpreter.html#907" class="Bound">v</a> <a id="909" class="Symbol">((</a><a id="911" href="V2.UntypedInterpreter.html#911" class="Bound">y</a> <a id="913" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="915" href="V2.UntypedInterpreter.html#915" class="Bound">w</a><a id="916" class="Symbol">)</a> <a id="918" href="Agda.Builtin.List.html#173" class="InductiveConstructor Operator">∷</a> <a id="920" href="V2.UntypedInterpreter.html#920" class="Bound">ρ</a><a id="921" class="Symbol">)</a> <a id="923" class="Symbol">=</a>
  <a id="927" href="Data.Bool.Base.html#1312" class="Function Operator">if</a> <a id="930" href="V2.UntypedInterpreter.html#905" class="Bound">x</a> <a id="932" href="Library.Eq.html#688" class="Function Operator">==</a> <a id="935" href="V2.UntypedInterpreter.html#911" class="Bound">y</a>
  <a id="939" href="Data.Bool.Base.html#1312" class="Function Operator">then</a> <a id="944" class="Symbol">(</a><a id="945" href="V2.UntypedInterpreter.html#905" class="Bound">x</a> <a id="947" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="949" href="V2.UntypedInterpreter.html#907" class="Bound">v</a><a id="950" class="Symbol">)</a> <a id="952" href="Agda.Builtin.List.html#173" class="InductiveConstructor Operator">∷</a> <a id="954" href="V2.UntypedInterpreter.html#920" class="Bound">ρ</a>
  <a id="958" href="Data.Bool.Base.html#1312" class="Function Operator">else</a> <a id="963" class="Symbol">(</a><a id="964" href="V2.UntypedInterpreter.html#911" class="Bound">y</a> <a id="966" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="968" href="V2.UntypedInterpreter.html#915" class="Bound">w</a><a id="969" class="Symbol">)</a> <a id="971" href="Agda.Builtin.List.html#173" class="InductiveConstructor Operator">∷</a> <a id="973" href="V2.UntypedInterpreter.html#819" class="Function">updateEnv</a> <a id="983" href="V2.UntypedInterpreter.html#905" class="Bound">x</a> <a id="985" href="V2.UntypedInterpreter.html#907" class="Bound">v</a> <a id="987" href="V2.UntypedInterpreter.html#920" class="Bound">ρ</a>

<a id="990" class="Comment">-- -- Poor man&#39;s version, keeps history of bindings.</a>
<a id="1043" class="Comment">-- updateEnv x v ρ = (x , v) ∷ ρ</a>
<a id="1076" class="Comment">-- updateEnv : Id → Val → Env → Env</a>

<a id="1113" class="Comment">-- Semantics of operations.</a>

<a id="1142" class="Comment">-- Boolean negation.</a>

<a id="bNot"></a><a id="1164" href="V2.UntypedInterpreter.html#1164" class="Function">bNot</a> <a id="1169" class="Symbol">:</a> <a id="1171" href="V2.AST.html#474" class="Datatype">Boolean</a> <a id="1179" class="Symbol">→</a> <a id="1181" href="V2.AST.html#474" class="Datatype">Boolean</a>
<a id="1189" href="V2.UntypedInterpreter.html#1164" class="Function">bNot</a> <a id="1194" href="V2.AST.html#496" class="InductiveConstructor">true</a> <a id="1199" class="Symbol">=</a> <a id="1201" href="V2.AST.html#501" class="InductiveConstructor">false</a>
<a id="1207" href="V2.UntypedInterpreter.html#1164" class="Function">bNot</a> <a id="1212" href="V2.AST.html#501" class="InductiveConstructor">false</a> <a id="1218" class="Symbol">=</a> <a id="1220" href="V2.AST.html#496" class="InductiveConstructor">true</a>

<a id="1226" class="Comment">-- Boolean conjunction.</a>

<a id="bAnd"></a><a id="1251" href="V2.UntypedInterpreter.html#1251" class="Function">bAnd</a> <a id="1256" class="Symbol">:</a> <a id="1258" href="V2.AST.html#474" class="Datatype">Boolean</a> <a id="1266" class="Symbol">→</a> <a id="1268" href="V2.AST.html#474" class="Datatype">Boolean</a> <a id="1276" class="Symbol">→</a> <a id="1278" href="V2.AST.html#474" class="Datatype">Boolean</a>
<a id="1286" href="V2.UntypedInterpreter.html#1251" class="Function">bAnd</a> <a id="1291" href="V2.AST.html#496" class="InductiveConstructor">true</a>  <a id="1297" href="V2.UntypedInterpreter.html#1297" class="Bound">b</a> <a id="1299" class="Symbol">=</a> <a id="1301" href="V2.UntypedInterpreter.html#1297" class="Bound">b</a>
<a id="1303" href="V2.UntypedInterpreter.html#1251" class="Function">bAnd</a> <a id="1308" href="V2.AST.html#501" class="InductiveConstructor">false</a> <a id="1314" class="Symbol">_</a> <a id="1316" class="Symbol">=</a> <a id="1318" href="V2.AST.html#501" class="InductiveConstructor">false</a>

<a id="1325" class="Comment">-- Greater-than on integers.</a>

<a id="iGt"></a><a id="1355" href="V2.UntypedInterpreter.html#1355" class="Function">iGt</a> <a id="1359" class="Symbol">:</a> <a id="1361" class="Symbol">(</a><a id="1362" href="V2.UntypedInterpreter.html#1362" class="Bound">i</a> <a id="1364" href="V2.UntypedInterpreter.html#1364" class="Bound">j</a> <a id="1366" class="Symbol">:</a> <a id="1368" href="Agda.Builtin.Int.html#219" class="Datatype">ℤ</a><a id="1369" class="Symbol">)</a> <a id="1371" class="Symbol">→</a> <a id="1373" href="V2.AST.html#474" class="Datatype">Boolean</a>
<a id="1381" href="V2.UntypedInterpreter.html#1355" class="Function">iGt</a> <a id="1385" href="V2.UntypedInterpreter.html#1385" class="Bound">i</a> <a id="1387" href="V2.UntypedInterpreter.html#1387" class="Bound">j</a> <a id="1389" class="Symbol">=</a> <a id="1391" href="Function.html#3662" class="Function Operator">case</a> <a id="1396" href="V2.UntypedInterpreter.html#1385" class="Bound">i</a> <a id="1398" href="Library.html#2213" class="Function Operator">Integer.&lt;=</a> <a id="1409" href="V2.UntypedInterpreter.html#1387" class="Bound">j</a> <a id="1411" href="Function.html#3662" class="Function Operator">of</a> <a id="1414" class="Symbol">λ</a> <a id="1416" class="Keyword">where</a>
  <a id="1424" href="Agda.Builtin.Bool.html#154" class="InductiveConstructor">false</a> <a id="1430" class="Symbol">→</a> <a id="1432" href="V2.AST.html#496" class="InductiveConstructor">true</a>
  <a id="1439" href="Agda.Builtin.Bool.html#160" class="InductiveConstructor">true</a>  <a id="1445" class="Symbol">→</a> <a id="1447" href="V2.AST.html#501" class="InductiveConstructor">false</a>

<a id="1454" class="Comment">-- Evaluation of expressions.  The environment is fixed.</a>

<a id="1512" class="Keyword">module</a> <a id="EvalExp"></a><a id="1519" href="V2.UntypedInterpreter.html#1519" class="Module">EvalExp</a> <a id="1527" class="Symbol">(</a><a id="1528" href="V2.UntypedInterpreter.html#1528" class="Bound">ρ</a> <a id="1530" class="Symbol">:</a> <a id="1532" href="V2.UntypedInterpreter.html#525" class="Function">Env</a><a id="1535" class="Symbol">)</a> <a id="1537" class="Keyword">where</a>

  <a id="1546" class="Comment">-- Evaluation may fail due to scope or type errors, thus eval is partial.</a>
  <a id="1622" class="Comment">-- E.g. eval (eNot (eInt zero)) ≡ nothing.</a>

  <a id="EvalExp.eval"></a><a id="1668" href="V2.UntypedInterpreter.html#1668" class="Function">eval</a> <a id="1673" class="Symbol">:</a> <a id="1675" href="V2.AST.html#584" class="Datatype">Exp</a> <a id="1679" class="Symbol">→</a> <a id="1681" href="Data.Maybe.Base.html#795" class="Datatype">Maybe</a> <a id="1687" href="V2.UntypedInterpreter.html#300" class="Datatype">Val</a>
  <a id="1693" href="V2.UntypedInterpreter.html#1668" class="Function">eval</a> <a id="1698" class="Symbol">(</a><a id="1699" href="V2.AST.html#602" class="InductiveConstructor">eId</a> <a id="1703" href="V2.UntypedInterpreter.html#1703" class="Bound">x</a><a id="1704" class="Symbol">)</a>   <a id="1708" class="Symbol">=</a> <a id="1710" href="V2.UntypedInterpreter.html#622" class="Function">lookupId</a> <a id="1719" href="V2.UntypedInterpreter.html#1528" class="Bound">ρ</a> <a id="1721" href="V2.UntypedInterpreter.html#1703" class="Bound">x</a>
  <a id="1725" href="V2.UntypedInterpreter.html#1668" class="Function">eval</a> <a id="1730" class="Symbol">(</a><a id="1731" href="V2.AST.html#636" class="InductiveConstructor">eInt</a> <a id="1736" href="V2.UntypedInterpreter.html#1736" class="Bound">i</a><a id="1737" class="Symbol">)</a>  <a id="1740" class="Symbol">=</a> <a id="1742" href="Data.Maybe.Base.html#829" class="InductiveConstructor">just</a> <a id="1747" class="Symbol">(</a><a id="1748" href="V2.UntypedInterpreter.html#318" class="InductiveConstructor">intV</a> <a id="1753" href="V2.UntypedInterpreter.html#1736" class="Bound">i</a><a id="1754" class="Symbol">)</a>
  <a id="1758" href="V2.UntypedInterpreter.html#1668" class="Function">eval</a> <a id="1763" class="Symbol">(</a><a id="1764" href="V2.AST.html#670" class="InductiveConstructor">eBool</a> <a id="1770" href="V2.UntypedInterpreter.html#1770" class="Bound">b</a><a id="1771" class="Symbol">)</a> <a id="1773" class="Symbol">=</a> <a id="1775" href="Data.Maybe.Base.html#829" class="InductiveConstructor">just</a> <a id="1780" class="Symbol">(</a><a id="1781" href="V2.UntypedInterpreter.html#342" class="InductiveConstructor">boolV</a> <a id="1787" href="V2.UntypedInterpreter.html#1770" class="Bound">b</a><a id="1788" class="Symbol">)</a>
  <a id="1792" href="V2.UntypedInterpreter.html#1668" class="Function">eval</a> <a id="1797" class="Symbol">(</a><a id="1798" href="V2.AST.html#704" class="InductiveConstructor">ePlus</a> <a id="1804" href="V2.UntypedInterpreter.html#1804" class="Bound">e₁</a> <a id="1807" href="V2.UntypedInterpreter.html#1807" class="Bound">e₂</a><a id="1809" class="Symbol">)</a> <a id="1811" class="Symbol">=</a> <a id="1813" href="Function.html#3662" class="Function Operator">case</a> <a id="1818" class="Symbol">(</a><a id="1819" href="V2.UntypedInterpreter.html#1668" class="Function">eval</a> <a id="1824" href="V2.UntypedInterpreter.html#1804" class="Bound">e₁</a> <a id="1827" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="1829" href="V2.UntypedInterpreter.html#1668" class="Function">eval</a> <a id="1834" href="V2.UntypedInterpreter.html#1807" class="Bound">e₂</a><a id="1836" class="Symbol">)</a> <a id="1838" href="Function.html#3662" class="Function Operator">of</a> <a id="1841" class="Symbol">λ</a> <a id="1843" class="Keyword">where</a>
    <a id="1853" class="Symbol">(</a><a id="1854" href="Data.Maybe.Base.html#829" class="InductiveConstructor">just</a> <a id="1859" class="Symbol">(</a><a id="1860" href="V2.UntypedInterpreter.html#318" class="InductiveConstructor">intV</a> <a id="1865" href="V2.UntypedInterpreter.html#1865" class="Bound">i</a><a id="1866" class="Symbol">)</a> <a id="1868" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="1870" href="Data.Maybe.Base.html#829" class="InductiveConstructor">just</a> <a id="1875" class="Symbol">(</a><a id="1876" href="V2.UntypedInterpreter.html#318" class="InductiveConstructor">intV</a> <a id="1881" href="V2.UntypedInterpreter.html#1881" class="Bound">j</a><a id="1882" class="Symbol">))</a> <a id="1885" class="Symbol">→</a> <a id="1887" href="Data.Maybe.Base.html#829" class="InductiveConstructor">just</a> <a id="1892" class="Symbol">(</a><a id="1893" href="V2.UntypedInterpreter.html#318" class="InductiveConstructor">intV</a> <a id="1898" class="Symbol">(</a><a id="1899" href="V2.UntypedInterpreter.html#1865" class="Bound">i</a> <a id="1901" href="Data.Integer.Base.html#2950" class="Function Operator">+</a> <a id="1903" href="V2.UntypedInterpreter.html#1881" class="Bound">j</a><a id="1904" class="Symbol">))</a>
    <a id="1911" class="CatchallClause Symbol">_</a> <a id="1913" class="Symbol">→</a> <a id="1915" href="Data.Maybe.Base.html#859" class="InductiveConstructor">nothing</a>
  <a id="1925" href="V2.UntypedInterpreter.html#1668" class="Function">eval</a> <a id="1930" class="Symbol">(</a><a id="1931" href="V2.AST.html#738" class="InductiveConstructor">eGt</a> <a id="1935" href="V2.UntypedInterpreter.html#1935" class="Bound">e₁</a> <a id="1938" href="V2.UntypedInterpreter.html#1938" class="Bound">e₂</a><a id="1940" class="Symbol">)</a> <a id="1942" class="Symbol">=</a> <a id="1944" href="Function.html#3662" class="Function Operator">case</a> <a id="1949" class="Symbol">(</a><a id="1950" href="V2.UntypedInterpreter.html#1668" class="Function">eval</a> <a id="1955" href="V2.UntypedInterpreter.html#1935" class="Bound">e₁</a> <a id="1958" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="1960" href="V2.UntypedInterpreter.html#1668" class="Function">eval</a> <a id="1965" href="V2.UntypedInterpreter.html#1938" class="Bound">e₂</a><a id="1967" class="Symbol">)</a> <a id="1969" href="Function.html#3662" class="Function Operator">of</a> <a id="1972" class="Symbol">λ</a> <a id="1974" class="Keyword">where</a>
    <a id="1984" class="Symbol">(</a><a id="1985" href="Data.Maybe.Base.html#829" class="InductiveConstructor">just</a> <a id="1990" class="Symbol">(</a><a id="1991" href="V2.UntypedInterpreter.html#318" class="InductiveConstructor">intV</a> <a id="1996" href="V2.UntypedInterpreter.html#1996" class="Bound">i</a><a id="1997" class="Symbol">)</a> <a id="1999" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="2001" href="Data.Maybe.Base.html#829" class="InductiveConstructor">just</a> <a id="2006" class="Symbol">(</a><a id="2007" href="V2.UntypedInterpreter.html#318" class="InductiveConstructor">intV</a> <a id="2012" href="V2.UntypedInterpreter.html#2012" class="Bound">j</a><a id="2013" class="Symbol">))</a> <a id="2016" class="Symbol">→</a> <a id="2018" href="Data.Maybe.Base.html#829" class="InductiveConstructor">just</a> <a id="2023" class="Symbol">(</a><a id="2024" href="V2.UntypedInterpreter.html#342" class="InductiveConstructor">boolV</a> <a id="2030" class="Symbol">(</a><a id="2031" href="V2.UntypedInterpreter.html#1355" class="Function">iGt</a> <a id="2035" href="V2.UntypedInterpreter.html#1996" class="Bound">i</a> <a id="2037" href="V2.UntypedInterpreter.html#2012" class="Bound">j</a><a id="2038" class="Symbol">))</a>
    <a id="2045" class="CatchallClause Symbol">_</a> <a id="2047" class="Symbol">→</a> <a id="2049" href="Data.Maybe.Base.html#859" class="InductiveConstructor">nothing</a>
  <a id="2059" href="V2.UntypedInterpreter.html#1668" class="Function">eval</a> <a id="2064" class="Symbol">(</a><a id="2065" href="V2.AST.html#772" class="InductiveConstructor">eAnd</a> <a id="2070" href="V2.UntypedInterpreter.html#2070" class="Bound">e₁</a> <a id="2073" href="V2.UntypedInterpreter.html#2073" class="Bound">e₂</a><a id="2075" class="Symbol">)</a> <a id="2077" class="Symbol">=</a> <a id="2079" href="Function.html#3662" class="Function Operator">case</a> <a id="2084" class="Symbol">(</a><a id="2085" href="V2.UntypedInterpreter.html#1668" class="Function">eval</a> <a id="2090" href="V2.UntypedInterpreter.html#2070" class="Bound">e₁</a> <a id="2093" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="2095" href="V2.UntypedInterpreter.html#1668" class="Function">eval</a> <a id="2100" href="V2.UntypedInterpreter.html#2073" class="Bound">e₂</a><a id="2102" class="Symbol">)</a> <a id="2104" href="Function.html#3662" class="Function Operator">of</a> <a id="2107" class="Symbol">λ</a> <a id="2109" class="Keyword">where</a>
    <a id="2119" class="Symbol">(</a><a id="2120" href="Data.Maybe.Base.html#829" class="InductiveConstructor">just</a> <a id="2125" class="Symbol">(</a><a id="2126" href="V2.UntypedInterpreter.html#342" class="InductiveConstructor">boolV</a> <a id="2132" href="V2.UntypedInterpreter.html#2132" class="Bound">b₁</a><a id="2134" class="Symbol">)</a> <a id="2136" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="2138" href="Data.Maybe.Base.html#829" class="InductiveConstructor">just</a> <a id="2143" class="Symbol">(</a><a id="2144" href="V2.UntypedInterpreter.html#342" class="InductiveConstructor">boolV</a> <a id="2150" href="V2.UntypedInterpreter.html#2150" class="Bound">b₂</a><a id="2152" class="Symbol">))</a> <a id="2155" class="Symbol">→</a> <a id="2157" href="Data.Maybe.Base.html#829" class="InductiveConstructor">just</a> <a id="2162" class="Symbol">(</a><a id="2163" href="V2.UntypedInterpreter.html#342" class="InductiveConstructor">boolV</a> <a id="2169" class="Symbol">(</a><a id="2170" href="V2.UntypedInterpreter.html#1251" class="Function">bAnd</a> <a id="2175" href="V2.UntypedInterpreter.html#2132" class="Bound">b₁</a> <a id="2178" href="V2.UntypedInterpreter.html#2150" class="Bound">b₂</a><a id="2180" class="Symbol">))</a>
    <a id="2187" class="CatchallClause Symbol">_</a> <a id="2189" class="Symbol">→</a> <a id="2191" href="Data.Maybe.Base.html#859" class="InductiveConstructor">nothing</a>

<a id="2200" class="Keyword">open</a> <a id="2205" href="V2.UntypedInterpreter.html#1519" class="Module">EvalExp</a>

<a id="2214" class="Comment">-- The execution of a declaration adds a new binding</a>
<a id="2267" class="Comment">-- to the environment.</a>

<a id="execDecl"></a><a id="2291" href="V2.UntypedInterpreter.html#2291" class="Function">execDecl</a> <a id="2300" class="Symbol">:</a> <a id="2302" href="V2.AST.html#907" class="Record">Decl</a> <a id="2307" class="Symbol">→</a> <a id="2309" href="V2.UntypedInterpreter.html#525" class="Function">Env</a> <a id="2313" class="Symbol">→</a> <a id="2315" href="Data.Maybe.Base.html#795" class="Datatype">Maybe</a> <a id="2321" href="V2.UntypedInterpreter.html#525" class="Function">Env</a>
<a id="2325" href="V2.UntypedInterpreter.html#2291" class="Function">execDecl</a> <a id="2334" class="Symbol">(</a><a id="2335" href="V2.AST.html#938" class="InductiveConstructor">dInit</a> <a id="2341" href="V2.UntypedInterpreter.html#2341" class="Bound">t</a> <a id="2343" href="V2.UntypedInterpreter.html#2343" class="Bound">x</a> <a id="2345" href="V2.UntypedInterpreter.html#2345" class="Bound">e</a><a id="2346" class="Symbol">)</a> <a id="2348" href="V2.UntypedInterpreter.html#2348" class="Bound">ρ</a> <a id="2350" class="Symbol">=</a> <a id="2352" href="Function.html#3662" class="Function Operator">case</a> <a id="2357" href="V2.UntypedInterpreter.html#1668" class="Function">eval</a> <a id="2362" href="V2.UntypedInterpreter.html#2348" class="Bound">ρ</a> <a id="2364" href="V2.UntypedInterpreter.html#2345" class="Bound">e</a> <a id="2366" href="Function.html#3662" class="Function Operator">of</a> <a id="2369" class="Symbol">λ</a> <a id="2371" class="Keyword">where</a>
  <a id="2379" class="Symbol">(</a><a id="2380" href="Data.Maybe.Base.html#829" class="InductiveConstructor">just</a> <a id="2385" href="V2.UntypedInterpreter.html#2385" class="Bound">v</a><a id="2386" class="Symbol">)</a> <a id="2388" class="Symbol">→</a> <a id="2390" href="Data.Maybe.Base.html#829" class="InductiveConstructor">just</a> <a id="2395" class="Symbol">((</a><a id="2397" href="V2.UntypedInterpreter.html#2343" class="Bound">x</a> <a id="2399" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="2401" href="V2.UntypedInterpreter.html#2385" class="Bound">v</a><a id="2402" class="Symbol">)</a> <a id="2404" href="Agda.Builtin.List.html#173" class="InductiveConstructor Operator">∷</a> <a id="2406" href="V2.UntypedInterpreter.html#2348" class="Bound">ρ</a><a id="2407" class="Symbol">)</a>
  <a id="2411" href="Data.Maybe.Base.html#859" class="InductiveConstructor">nothing</a>  <a id="2420" class="Symbol">→</a> <a id="2422" href="Data.Maybe.Base.html#859" class="InductiveConstructor">nothing</a>

<a id="2431" class="Comment">-- Execution of declarations returns the extended environment.</a>

<a id="execDecls"></a><a id="2495" href="V2.UntypedInterpreter.html#2495" class="Function">execDecls</a> <a id="2505" class="Symbol">:</a> <a id="2507" href="Agda.Builtin.List.html#121" class="Datatype">List</a> <a id="2512" href="V2.AST.html#907" class="Record">Decl</a> <a id="2517" class="Symbol">→</a> <a id="2519" href="V2.UntypedInterpreter.html#525" class="Function">Env</a> <a id="2523" class="Symbol">→</a> <a id="2525" href="Data.Maybe.Base.html#795" class="Datatype">Maybe</a> <a id="2531" href="V2.UntypedInterpreter.html#525" class="Function">Env</a>
<a id="2535" href="V2.UntypedInterpreter.html#2495" class="Function">execDecls</a> <a id="2545" href="Agda.Builtin.List.html#158" class="InductiveConstructor">[]</a> <a id="2548" href="V2.UntypedInterpreter.html#2548" class="Bound">ρ</a> <a id="2550" class="Symbol">=</a> <a id="2552" href="Data.Maybe.Base.html#829" class="InductiveConstructor">just</a> <a id="2557" href="V2.UntypedInterpreter.html#2548" class="Bound">ρ</a>
<a id="2559" href="V2.UntypedInterpreter.html#2495" class="Function">execDecls</a> <a id="2569" class="Symbol">(</a><a id="2570" href="V2.UntypedInterpreter.html#2570" class="Bound">d</a> <a id="2572" href="Agda.Builtin.List.html#173" class="InductiveConstructor Operator">∷</a> <a id="2574" href="V2.UntypedInterpreter.html#2574" class="Bound">ds</a><a id="2576" class="Symbol">)</a> <a id="2578" href="V2.UntypedInterpreter.html#2578" class="Bound">ρ</a> <a id="2580" class="Symbol">=</a> <a id="2582" href="Function.html#3662" class="Function Operator">case</a> <a id="2587" href="V2.UntypedInterpreter.html#2291" class="Function">execDecl</a> <a id="2596" href="V2.UntypedInterpreter.html#2570" class="Bound">d</a> <a id="2598" href="V2.UntypedInterpreter.html#2578" class="Bound">ρ</a> <a id="2600" href="Function.html#3662" class="Function Operator">of</a> <a id="2603" class="Symbol">λ</a> <a id="2605" class="Keyword">where</a>
  <a id="2613" class="Symbol">(</a><a id="2614" href="Data.Maybe.Base.html#829" class="InductiveConstructor">just</a> <a id="2619" href="V2.UntypedInterpreter.html#2619" class="Bound">ρ&#39;</a><a id="2621" class="Symbol">)</a> <a id="2623" class="Symbol">→</a> <a id="2625" href="V2.UntypedInterpreter.html#2495" class="Function">execDecls</a> <a id="2635" href="V2.UntypedInterpreter.html#2574" class="Bound">ds</a> <a id="2638" href="V2.UntypedInterpreter.html#2619" class="Bound">ρ&#39;</a>
  <a id="2643" href="Data.Maybe.Base.html#859" class="InductiveConstructor">nothing</a>   <a id="2653" class="Symbol">→</a> <a id="2655" href="Data.Maybe.Base.html#859" class="InductiveConstructor">nothing</a>

<a id="2664" class="Comment">-- We evaluate a program by first executing the declarations,</a>
<a id="2726" class="Comment">-- and then evaluating the main expression.</a>

<a id="evalPrg"></a><a id="2771" href="V2.UntypedInterpreter.html#2771" class="Function">evalPrg</a> <a id="2779" class="Symbol">:</a> <a id="2781" href="V2.AST.html#1090" class="Record">Program</a> <a id="2789" class="Symbol">→</a> <a id="2791" href="Data.Maybe.Base.html#795" class="Datatype">Maybe</a> <a id="2797" href="Agda.Builtin.Int.html#219" class="Datatype">ℤ</a>
<a id="2799" href="V2.UntypedInterpreter.html#2771" class="Function">evalPrg</a> <a id="2807" class="Symbol">(</a><a id="2808" href="V2.AST.html#1124" class="InductiveConstructor">program</a> <a id="2816" href="V2.UntypedInterpreter.html#2816" class="Bound">ds</a> <a id="2819" href="V2.UntypedInterpreter.html#2819" class="Bound">e</a><a id="2820" class="Symbol">)</a> <a id="2822" class="Symbol">=</a> <a id="2824" href="Function.html#3662" class="Function Operator">case</a> <a id="2829" href="V2.UntypedInterpreter.html#2495" class="Function">execDecls</a> <a id="2839" href="V2.UntypedInterpreter.html#2816" class="Bound">ds</a> <a id="2842" href="Agda.Builtin.List.html#158" class="InductiveConstructor">[]</a> <a id="2845" href="Function.html#3662" class="Function Operator">of</a> <a id="2848" class="Symbol">λ</a> <a id="2850" class="Keyword">where</a>
  <a id="2858" class="Symbol">(</a><a id="2859" href="Data.Maybe.Base.html#829" class="InductiveConstructor">just</a> <a id="2864" href="V2.UntypedInterpreter.html#2864" class="Bound">ρ</a><a id="2865" class="Symbol">)</a> <a id="2867" class="Symbol">→</a> <a id="2869" href="Function.html#3662" class="Function Operator">case</a> <a id="2874" href="V2.UntypedInterpreter.html#1668" class="Function">eval</a> <a id="2879" href="V2.UntypedInterpreter.html#2864" class="Bound">ρ</a> <a id="2881" href="V2.UntypedInterpreter.html#2819" class="Bound">e</a> <a id="2883" href="Function.html#3662" class="Function Operator">of</a> <a id="2886" class="Symbol">λ</a> <a id="2888" class="Keyword">where</a>
    <a id="2898" class="Symbol">(</a><a id="2899" href="Data.Maybe.Base.html#829" class="InductiveConstructor">just</a> <a id="2904" class="Symbol">(</a><a id="2905" href="V2.UntypedInterpreter.html#318" class="InductiveConstructor">intV</a> <a id="2910" href="V2.UntypedInterpreter.html#2910" class="Bound">v</a><a id="2911" class="Symbol">))</a> <a id="2914" class="Symbol">→</a> <a id="2916" href="Data.Maybe.Base.html#829" class="InductiveConstructor">just</a> <a id="2921" href="V2.UntypedInterpreter.html#2910" class="Bound">v</a>
    <a id="2927" class="CatchallClause Symbol">_</a>               <a id="2943" class="Symbol">→</a> <a id="2945" href="Data.Maybe.Base.html#859" class="InductiveConstructor">nothing</a>
  <a id="2955" href="Data.Maybe.Base.html#859" class="InductiveConstructor">nothing</a>   <a id="2965" class="Symbol">→</a> <a id="2967" href="Data.Maybe.Base.html#859" class="InductiveConstructor">nothing</a>
</pre></body></html>