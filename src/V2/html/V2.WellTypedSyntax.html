<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>V2.WellTypedSyntax</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Comment">-- Intrinsically well-typed WHILE syntax.</a>

<a id="44" class="Keyword">module</a> <a id="51" href="V2.WellTypedSyntax.html" class="Module">V2.WellTypedSyntax</a> <a id="70" class="Keyword">where</a>

<a id="77" class="Keyword">open</a> <a id="82" class="Keyword">import</a> <a id="89" href="Library.html" class="Module">Library</a>
<a id="97" class="Keyword">open</a> <a id="102" class="Keyword">import</a> <a id="109" href="V2.AST.html" class="Module">V2.AST</a> <a id="116" class="Keyword">public</a> <a id="123" class="Keyword">using</a> <a id="129" class="Symbol">(</a><a id="130" href="V2.AST.html#372" class="Datatype">Type</a><a id="134" class="Symbol">;</a> <a id="136" href="V2.AST.html#391" class="InductiveConstructor">bool</a><a id="140" class="Symbol">;</a> <a id="142" href="V2.AST.html#396" class="InductiveConstructor">int</a><a id="145" class="Symbol">;</a> <a id="147" href="V2.AST.html#474" class="Datatype">Boolean</a><a id="154" class="Symbol">;</a> <a id="156" href="V2.AST.html#496" class="InductiveConstructor">true</a><a id="160" class="Symbol">;</a> <a id="162" href="V2.AST.html#501" class="InductiveConstructor">false</a><a id="167" class="Symbol">;</a> <a id="169" href="V2.AST.html#1993" class="Function">PrintBoolean</a><a id="181" class="Symbol">)</a>

<a id="184" class="Comment">-- Variables are de Bruijn indices into the context, a list of types.</a>

<a id="Cxt"></a><a id="255" href="V2.WellTypedSyntax.html#255" class="Function">Cxt</a> <a id="259" class="Symbol">=</a> <a id="261" href="Agda.Builtin.List.html#121" class="Datatype">List</a> <a id="266" href="V2.AST.html#372" class="Datatype">Type</a>

<a id="Var"></a><a id="272" href="V2.WellTypedSyntax.html#272" class="Function">Var</a> <a id="276" class="Symbol">:</a> <a id="278" class="Symbol">(</a><a id="279" href="V2.WellTypedSyntax.html#279" class="Bound">Γ</a> <a id="281" class="Symbol">:</a> <a id="283" href="V2.WellTypedSyntax.html#255" class="Function">Cxt</a><a id="286" class="Symbol">)</a> <a id="288" class="Symbol">(</a><a id="289" href="V2.WellTypedSyntax.html#289" class="Bound">t</a> <a id="291" class="Symbol">:</a> <a id="293" href="V2.AST.html#372" class="Datatype">Type</a><a id="297" class="Symbol">)</a> <a id="299" class="Symbol">→</a> <a id="301" class="PrimitiveType">Set</a>
<a id="305" href="V2.WellTypedSyntax.html#272" class="Function">Var</a> <a id="309" href="V2.WellTypedSyntax.html#309" class="Bound">Γ</a> <a id="311" href="V2.WellTypedSyntax.html#311" class="Bound">t</a> <a id="313" class="Symbol">=</a> <a id="315" href="V2.WellTypedSyntax.html#311" class="Bound">t</a> <a id="317" href="Data.List.Membership.Setoid.html#877" class="Function Operator">∈</a> <a id="319" href="V2.WellTypedSyntax.html#309" class="Bound">Γ</a>

<a id="322" class="Comment">-- Binary Operators.</a>

<a id="344" class="Keyword">data</a> <a id="Op"></a><a id="349" href="V2.WellTypedSyntax.html#349" class="Datatype">Op</a> <a id="352" class="Symbol">:</a> <a id="354" class="Symbol">(</a><a id="355" href="V2.WellTypedSyntax.html#355" class="Bound">dom</a> <a id="359" href="V2.WellTypedSyntax.html#359" class="Bound">codom</a> <a id="365" class="Symbol">:</a> <a id="367" href="V2.AST.html#372" class="Datatype">Type</a><a id="371" class="Symbol">)</a> <a id="373" class="Symbol">→</a> <a id="375" class="PrimitiveType">Set</a> <a id="379" class="Keyword">where</a>
  <a id="Op.plus"></a><a id="387" href="V2.WellTypedSyntax.html#387" class="InductiveConstructor">plus</a>  <a id="393" class="Symbol">:</a> <a id="395" href="V2.WellTypedSyntax.html#349" class="Datatype">Op</a> <a id="398" href="V2.AST.html#396" class="InductiveConstructor">int</a>  <a id="403" href="V2.AST.html#396" class="InductiveConstructor">int</a>
  <a id="Op.gt"></a><a id="409" href="V2.WellTypedSyntax.html#409" class="InductiveConstructor">gt</a>    <a id="415" class="Symbol">:</a> <a id="417" href="V2.WellTypedSyntax.html#349" class="Datatype">Op</a> <a id="420" href="V2.AST.html#396" class="InductiveConstructor">int</a>  <a id="425" href="V2.AST.html#391" class="InductiveConstructor">bool</a>
  <a id="Op.and"></a><a id="432" href="V2.WellTypedSyntax.html#432" class="InductiveConstructor">and</a>   <a id="438" class="Symbol">:</a> <a id="440" href="V2.WellTypedSyntax.html#349" class="Datatype">Op</a> <a id="443" href="V2.AST.html#391" class="InductiveConstructor">bool</a> <a id="448" href="V2.AST.html#391" class="InductiveConstructor">bool</a>

<a id="454" class="Comment">-- Well-typed expressions: context is fixed.</a>

<a id="500" class="Keyword">data</a> <a id="Exp"></a><a id="505" href="V2.WellTypedSyntax.html#505" class="Datatype">Exp</a> <a id="509" class="Symbol">(</a><a id="510" href="V2.WellTypedSyntax.html#510" class="Bound">Γ</a> <a id="512" class="Symbol">:</a> <a id="514" href="V2.WellTypedSyntax.html#255" class="Function">Cxt</a><a id="517" class="Symbol">)</a> <a id="519" class="Symbol">:</a> <a id="521" href="V2.AST.html#372" class="Datatype">Type</a> <a id="526" class="Symbol">→</a> <a id="528" class="PrimitiveType">Set</a> <a id="532" class="Keyword">where</a>
  <a id="540" class="Comment">-- Literals:</a>
  <a id="Exp.eInt"></a><a id="555" href="V2.WellTypedSyntax.html#555" class="InductiveConstructor">eInt</a>  <a id="561" class="Symbol">:</a> <a id="563" class="Symbol">(</a><a id="564" href="V2.WellTypedSyntax.html#564" class="Bound">i</a> <a id="566" class="Symbol">:</a> <a id="568" href="Agda.Builtin.Int.html#219" class="Datatype">ℤ</a><a id="569" class="Symbol">)</a>                                 <a id="603" class="Symbol">→</a> <a id="605" href="V2.WellTypedSyntax.html#505" class="Datatype">Exp</a> <a id="609" href="V2.WellTypedSyntax.html#510" class="Bound">Γ</a> <a id="611" href="V2.AST.html#396" class="InductiveConstructor">int</a>
  <a id="Exp.eBool"></a><a id="617" href="V2.WellTypedSyntax.html#617" class="InductiveConstructor">eBool</a> <a id="623" class="Symbol">:</a> <a id="625" class="Symbol">(</a><a id="626" href="V2.WellTypedSyntax.html#626" class="Bound">b</a> <a id="628" class="Symbol">:</a> <a id="630" href="V2.AST.html#474" class="Datatype">Boolean</a><a id="637" class="Symbol">)</a>                           <a id="665" class="Symbol">→</a> <a id="667" href="V2.WellTypedSyntax.html#505" class="Datatype">Exp</a> <a id="671" href="V2.WellTypedSyntax.html#510" class="Bound">Γ</a> <a id="673" href="V2.AST.html#391" class="InductiveConstructor">bool</a>
  <a id="680" class="Comment">-- Operators:</a>
  <a id="Exp.eOp"></a><a id="696" href="V2.WellTypedSyntax.html#696" class="InductiveConstructor">eOp</a>   <a id="702" class="Symbol">:</a> <a id="704" class="Symbol">∀{</a><a id="706" href="V2.WellTypedSyntax.html#706" class="Bound">t</a> <a id="708" href="V2.WellTypedSyntax.html#708" class="Bound">t&#39;</a><a id="710" class="Symbol">}</a> <a id="712" class="Symbol">(</a><a id="713" href="V2.WellTypedSyntax.html#713" class="Bound">op</a> <a id="716" class="Symbol">:</a> <a id="718" href="V2.WellTypedSyntax.html#349" class="Datatype">Op</a> <a id="721" href="V2.WellTypedSyntax.html#706" class="Bound">t</a> <a id="723" href="V2.WellTypedSyntax.html#708" class="Bound">t&#39;</a><a id="725" class="Symbol">)</a> <a id="727" class="Symbol">(</a><a id="728" href="V2.WellTypedSyntax.html#728" class="Bound">e</a> <a id="730" href="V2.WellTypedSyntax.html#730" class="Bound">e&#39;</a> <a id="733" class="Symbol">:</a> <a id="735" href="V2.WellTypedSyntax.html#505" class="Datatype">Exp</a> <a id="739" href="V2.WellTypedSyntax.html#510" class="Bound">Γ</a> <a id="741" href="V2.WellTypedSyntax.html#706" class="Bound">t</a><a id="742" class="Symbol">)</a> <a id="744" class="Symbol">→</a> <a id="746" href="V2.WellTypedSyntax.html#505" class="Datatype">Exp</a> <a id="750" href="V2.WellTypedSyntax.html#510" class="Bound">Γ</a> <a id="752" href="V2.WellTypedSyntax.html#708" class="Bound">t&#39;</a>
  <a id="757" class="Comment">-- Variables:</a>
  <a id="Exp.eVar"></a><a id="773" href="V2.WellTypedSyntax.html#773" class="InductiveConstructor">eVar</a>  <a id="779" class="Symbol">:</a> <a id="781" class="Symbol">∀{</a><a id="783" href="V2.WellTypedSyntax.html#783" class="Bound">t</a><a id="784" class="Symbol">}</a>    <a id="789" class="Symbol">(</a><a id="790" href="V2.WellTypedSyntax.html#790" class="Bound">x</a> <a id="792" class="Symbol">:</a> <a id="794" href="V2.WellTypedSyntax.html#272" class="Function">Var</a> <a id="798" href="V2.WellTypedSyntax.html#510" class="Bound">Γ</a> <a id="800" href="V2.WellTypedSyntax.html#783" class="Bound">t</a><a id="801" class="Symbol">)</a>                   <a id="821" class="Symbol">→</a> <a id="823" href="V2.WellTypedSyntax.html#505" class="Datatype">Exp</a> <a id="827" href="V2.WellTypedSyntax.html#510" class="Bound">Γ</a> <a id="829" href="V2.WellTypedSyntax.html#783" class="Bound">t</a>

<a id="832" class="Comment">-- Well-typed declarations (extending the context).</a>

<a id="885" class="Keyword">data</a> <a id="Decl"></a><a id="890" href="V2.WellTypedSyntax.html#890" class="Datatype">Decl</a> <a id="895" class="Symbol">(</a><a id="896" href="V2.WellTypedSyntax.html#896" class="Bound">Γ</a> <a id="898" class="Symbol">:</a> <a id="900" href="V2.WellTypedSyntax.html#255" class="Function">Cxt</a><a id="903" class="Symbol">)</a> <a id="905" class="Symbol">(</a><a id="906" href="V2.WellTypedSyntax.html#906" class="Bound">t</a> <a id="908" class="Symbol">:</a> <a id="910" href="V2.AST.html#372" class="Datatype">Type</a><a id="914" class="Symbol">)</a> <a id="916" class="Symbol">:</a> <a id="918" class="PrimitiveType">Set</a> <a id="922" class="Keyword">where</a>
  <a id="Decl.dInit"></a><a id="930" href="V2.WellTypedSyntax.html#930" class="InductiveConstructor">dInit</a> <a id="936" class="Symbol">:</a> <a id="938" class="Symbol">(</a><a id="939" href="V2.WellTypedSyntax.html#939" class="Bound">e</a> <a id="941" class="Symbol">:</a> <a id="943" href="V2.WellTypedSyntax.html#505" class="Datatype">Exp</a> <a id="947" href="V2.WellTypedSyntax.html#896" class="Bound">Γ</a> <a id="949" href="V2.WellTypedSyntax.html#906" class="Bound">t</a><a id="950" class="Symbol">)</a> <a id="952" class="Symbol">→</a> <a id="954" href="V2.WellTypedSyntax.html#890" class="Datatype">Decl</a> <a id="959" href="V2.WellTypedSyntax.html#896" class="Bound">Γ</a> <a id="961" href="V2.WellTypedSyntax.html#906" class="Bound">t</a>

<a id="964" class="Keyword">data</a> <a id="Decls"></a><a id="969" href="V2.WellTypedSyntax.html#969" class="Datatype">Decls</a> <a id="975" class="Symbol">(</a><a id="976" href="V2.WellTypedSyntax.html#976" class="Bound">Γ</a> <a id="978" class="Symbol">:</a> <a id="980" href="V2.WellTypedSyntax.html#255" class="Function">Cxt</a><a id="983" class="Symbol">)</a> <a id="985" class="Symbol">:</a> <a id="987" href="V2.WellTypedSyntax.html#255" class="Function">Cxt</a> <a id="991" class="Symbol">→</a> <a id="993" class="PrimitiveType">Set</a> <a id="997" class="Keyword">where</a>
  <a id="Decls.[]"></a><a id="1005" href="V2.WellTypedSyntax.html#1005" class="InductiveConstructor">[]</a>  <a id="1009" class="Symbol">:</a> <a id="1011" href="V2.WellTypedSyntax.html#969" class="Datatype">Decls</a> <a id="1017" href="V2.WellTypedSyntax.html#976" class="Bound">Γ</a> <a id="1019" href="V2.WellTypedSyntax.html#976" class="Bound">Γ</a>
  <a id="Decls._∷_"></a><a id="1023" href="V2.WellTypedSyntax.html#1023" class="InductiveConstructor Operator">_∷_</a> <a id="1027" class="Symbol">:</a> <a id="1029" class="Symbol">∀{</a><a id="1031" href="V2.WellTypedSyntax.html#1031" class="Bound">t</a> <a id="1033" href="V2.WellTypedSyntax.html#1033" class="Bound">Γ′</a><a id="1035" class="Symbol">}</a> <a id="1037" class="Symbol">(</a><a id="1038" href="V2.WellTypedSyntax.html#1038" class="Bound">s</a> <a id="1040" class="Symbol">:</a> <a id="1042" href="V2.WellTypedSyntax.html#890" class="Datatype">Decl</a> <a id="1047" href="V2.WellTypedSyntax.html#976" class="Bound">Γ</a> <a id="1049" href="V2.WellTypedSyntax.html#1031" class="Bound">t</a><a id="1050" class="Symbol">)</a> <a id="1052" class="Symbol">(</a><a id="1053" href="V2.WellTypedSyntax.html#1053" class="Bound">ss</a> <a id="1056" class="Symbol">:</a> <a id="1058" href="V2.WellTypedSyntax.html#969" class="Datatype">Decls</a> <a id="1064" class="Symbol">(</a><a id="1065" href="V2.WellTypedSyntax.html#1031" class="Bound">t</a> <a id="1067" href="Agda.Builtin.List.html#173" class="InductiveConstructor Operator">∷</a> <a id="1069" href="V2.WellTypedSyntax.html#976" class="Bound">Γ</a><a id="1070" class="Symbol">)</a> <a id="1072" href="V2.WellTypedSyntax.html#1033" class="Bound">Γ′</a><a id="1074" class="Symbol">)</a> <a id="1076" class="Symbol">→</a> <a id="1078" href="V2.WellTypedSyntax.html#969" class="Datatype">Decls</a> <a id="1084" href="V2.WellTypedSyntax.html#976" class="Bound">Γ</a> <a id="1086" href="V2.WellTypedSyntax.html#1033" class="Bound">Γ′</a>

<a id="1090" class="Comment">-- A program is a list of statements and a final expression.</a>

<a id="1152" class="Keyword">record</a> <a id="Program"></a><a id="1159" href="V2.WellTypedSyntax.html#1159" class="Record">Program</a> <a id="1167" class="Symbol">:</a> <a id="1169" class="PrimitiveType">Set</a> <a id="1173" class="Keyword">where</a>
  <a id="1181" class="Keyword">constructor</a> <a id="Program.program"></a><a id="1193" href="V2.WellTypedSyntax.html#1193" class="InductiveConstructor">program</a>
  <a id="1203" class="Keyword">field</a>
    <a id="1213" class="Symbol">{</a><a id="Program.Γ"></a><a id="1214" href="V2.WellTypedSyntax.html#1214" class="Field">Γ</a><a id="1215" class="Symbol">}</a>      <a id="1222" class="Symbol">:</a> <a id="1224" href="V2.WellTypedSyntax.html#255" class="Function">Cxt</a>
    <a id="Program.theDecls"></a><a id="1232" href="V2.WellTypedSyntax.html#1232" class="Field">theDecls</a> <a id="1241" class="Symbol">:</a> <a id="1243" href="V2.WellTypedSyntax.html#969" class="Datatype">Decls</a> <a id="1249" href="Agda.Builtin.List.html#158" class="InductiveConstructor">[]</a> <a id="1252" href="V2.WellTypedSyntax.html#1214" class="Field">Γ</a>
    <a id="Program.theMain"></a><a id="1258" href="V2.WellTypedSyntax.html#1258" class="Field">theMain</a>  <a id="1267" class="Symbol">:</a> <a id="1269" href="V2.WellTypedSyntax.html#505" class="Datatype">Exp</a> <a id="1273" href="V2.WellTypedSyntax.html#1214" class="Field">Γ</a> <a id="1275" href="V2.AST.html#396" class="InductiveConstructor">int</a>

<a id="1280" class="Keyword">open</a> <a id="1285" href="V2.WellTypedSyntax.html#1159" class="Module">Program</a> <a id="1293" class="Keyword">public</a>


<a id="1302" class="Comment">-- -}</a>
</pre></body></html>