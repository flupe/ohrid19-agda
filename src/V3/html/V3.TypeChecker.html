<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>V3.TypeChecker</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Comment">-- Type checker for the WHILE language.</a>

<a id="42" class="Symbol">{-#</a> <a id="46" class="Keyword">OPTIONS</a> <a id="54" class="Pragma">--postfix-projections</a> <a id="76" class="Symbol">#-}</a>

<a id="81" class="Keyword">module</a> <a id="88" href="V3.TypeChecker.html" class="Module">V3.TypeChecker</a> <a id="103" class="Keyword">where</a>

<a id="110" class="Keyword">open</a> <a id="115" class="Keyword">import</a> <a id="122" href="Library.html" class="Module">Library</a>

<a id="131" class="Keyword">import</a> <a id="138" href="V3.AST.html" class="Module">V3.AST</a> <a id="145" class="Symbol">as</a> <a id="148" class="Module">A</a>
<a id="150" class="Keyword">open</a> <a id="155" class="Keyword">import</a> <a id="162" href="V3.WellTypedSyntax.html" class="Module">V3.WellTypedSyntax</a>

<a id="182" class="Comment">-- Names as coming from the abstract syntax are just strings.</a>

<a id="Name"></a><a id="245" href="V3.TypeChecker.html#245" class="Function">Name</a> <a id="250" class="Symbol">=</a> <a id="252" href="Agda.Builtin.String.html#247" class="Postulate">String</a>

<a id="idToName"></a><a id="260" href="V3.TypeChecker.html#260" class="Function">idToName</a> <a id="269" class="Symbol">:</a> <a id="271" href="V3.AST.html#282" class="Datatype">A.Id</a> <a id="276" class="Symbol">→</a> <a id="278" href="V3.TypeChecker.html#245" class="Function">Name</a>
<a id="283" href="V3.TypeChecker.html#260" class="Function">idToName</a> <a id="292" class="Symbol">(</a><a id="293" href="V3.AST.html#299" class="InductiveConstructor">A.mkId</a> <a id="300" href="V3.TypeChecker.html#300" class="Bound">x</a><a id="301" class="Symbol">)</a> <a id="303" class="Symbol">=</a> <a id="305" href="Agda.Builtin.String.html#345" class="Primitive">String.fromList</a> <a id="321" href="V3.TypeChecker.html#300" class="Bound">x</a>

<a id="324" class="Comment">-- Local context for the type checker.</a>

<a id="TCCxt"></a><a id="364" href="V3.TypeChecker.html#364" class="Function">TCCxt</a> <a id="370" class="Symbol">:</a> <a id="372" class="Symbol">(</a><a id="373" href="V3.TypeChecker.html#373" class="Bound">Γ</a> <a id="375" class="Symbol">:</a> <a id="377" href="V3.WellTypedSyntax.html#255" class="Function">Cxt</a><a id="380" class="Symbol">)</a> <a id="382" class="Symbol">→</a> <a id="384" class="PrimitiveType">Set</a>
<a id="388" href="V3.TypeChecker.html#364" class="Function">TCCxt</a> <a id="394" href="V3.TypeChecker.html#394" class="Bound">Γ</a> <a id="396" class="Symbol">=</a> <a id="398" href="Library.List.html#425" class="Function">AssocList</a> <a id="408" href="V3.TypeChecker.html#245" class="Function">Name</a> <a id="413" href="V3.TypeChecker.html#394" class="Bound">Γ</a>

<a id="416" class="Comment">-- Querying the local context.</a>

<a id="448" class="Comment">-- Type errors.</a>
<a id="464" class="Comment">--</a>
<a id="467" class="Comment">-- Currently, these errors do not carry enough evidence that</a>
<a id="528" class="Comment">-- something is wrong.  The type checker does not produce</a>
<a id="586" class="Comment">-- evidence of ill-typedness in case of failure,</a>
<a id="635" class="Comment">-- only of well-typedness in case of success.</a>

<a id="682" class="Keyword">data</a> <a id="TypeError"></a><a id="687" href="V3.TypeChecker.html#687" class="Datatype">TypeError</a> <a id="697" class="Symbol">:</a> <a id="699" class="PrimitiveType">Set</a> <a id="703" class="Keyword">where</a>
  <a id="TypeError.unboundVariable"></a><a id="711" href="V3.TypeChecker.html#711" class="InductiveConstructor">unboundVariable</a>        <a id="734" class="Symbol">:</a> <a id="736" href="V3.TypeChecker.html#245" class="Function">Name</a> <a id="741" class="Symbol">→</a> <a id="743" href="V3.TypeChecker.html#687" class="Datatype">TypeError</a>
  <a id="TypeError.typeMismatch"></a><a id="755" href="V3.TypeChecker.html#755" class="InductiveConstructor">typeMismatch</a>           <a id="778" class="Symbol">:</a> <a id="780" class="Symbol">(</a><a id="781" href="V3.TypeChecker.html#781" class="Bound">tinf</a> <a id="786" href="V3.TypeChecker.html#786" class="Bound">texp</a> <a id="791" class="Symbol">:</a> <a id="793" href="V3.AST.html#372" class="Datatype">Type</a><a id="797" class="Symbol">)</a>  <a id="800" class="Symbol">→</a> <a id="802" href="V3.TypeChecker.html#781" class="Bound">tinf</a> <a id="807" href="Relation.Binary.PropositionalEquality.Core.html#799" class="Function Operator">≢</a> <a id="809" href="V3.TypeChecker.html#786" class="Bound">texp</a> <a id="814" class="Symbol">→</a> <a id="816" href="V3.TypeChecker.html#687" class="Datatype">TypeError</a>

<a id="827" class="Keyword">instance</a>
  <a id="PrintError"></a><a id="838" href="V3.TypeChecker.html#838" class="Function">PrintError</a> <a id="849" class="Symbol">:</a> <a id="851" href="Library.Print.html#196" class="Record">Print</a> <a id="857" href="V3.TypeChecker.html#687" class="Datatype">TypeError</a>
  <a id="869" href="Library.Print.html#244" class="Field">print</a> <a id="875" class="Symbol">{{</a><a id="877" href="V3.TypeChecker.html#838" class="Function">PrintError</a><a id="887" class="Symbol">}}</a> <a id="890" class="Symbol">=</a> <a id="892" class="Symbol">λ</a> <a id="894" class="Keyword">where</a>
    <a id="904" class="Symbol">(</a><a id="905" href="V3.TypeChecker.html#711" class="InductiveConstructor">unboundVariable</a> <a id="921" href="V3.TypeChecker.html#921" class="Bound">x</a><a id="922" class="Symbol">)</a>        <a id="931" class="Symbol">→</a> <a id="933" class="String">&quot;unbound variable &quot;</a> <a id="953" href="Data.String.Base.html#1744" class="Function Operator">String.++</a> <a id="963" href="V3.TypeChecker.html#921" class="Bound">x</a>
    <a id="969" class="Symbol">(</a><a id="970" href="V3.TypeChecker.html#755" class="InductiveConstructor">typeMismatch</a> <a id="983" href="V3.TypeChecker.html#983" class="Bound">tinf</a> <a id="988" href="V3.TypeChecker.html#988" class="Bound">texp</a> <a id="993" class="Symbol">_)</a> <a id="996" class="Symbol">→</a> <a id="998" href="Data.String.Base.html#1932" class="Function">String.concat</a> <a id="1012" href="Function.html#1645" class="Function Operator">$</a>
      <a id="1020" class="String">&quot;type mismatch: expected &quot;</a> <a id="1047" href="Agda.Builtin.List.html#173" class="InductiveConstructor Operator">∷</a> <a id="1049" href="Library.Print.html#244" class="Field">print</a> <a id="1055" href="V3.TypeChecker.html#988" class="Bound">texp</a> <a id="1060" href="Agda.Builtin.List.html#173" class="InductiveConstructor Operator">∷</a>
      <a id="1068" class="String">&quot;, but inferred &quot;</a> <a id="1086" href="Agda.Builtin.List.html#173" class="InductiveConstructor Operator">∷</a> <a id="1088" href="Library.Print.html#244" class="Field">print</a> <a id="1094" href="V3.TypeChecker.html#983" class="Bound">tinf</a> <a id="1099" href="Agda.Builtin.List.html#173" class="InductiveConstructor Operator">∷</a> <a id="1101" href="Agda.Builtin.List.html#158" class="InductiveConstructor">[]</a>

<a id="1105" class="Comment">-- Type error monad.</a>

<a id="1127" class="Keyword">open</a> <a id="1132" href="Library.Error.html#134" class="Module">ErrorMonad</a> <a id="1143" class="Symbol">{</a><a id="1144" class="Argument">E</a> <a id="1146" class="Symbol">=</a> <a id="1148" href="V3.TypeChecker.html#687" class="Datatype">TypeError</a><a id="1157" class="Symbol">}</a>

<a id="1160" class="Comment">-- Checking variables</a>
<a id="1182" class="Comment">---------------------------------------------------------------------------</a>

<a id="lookupVar"></a><a id="1259" href="V3.TypeChecker.html#1259" class="Function">lookupVar</a> <a id="1269" class="Symbol">:</a> <a id="1271" class="Symbol">{</a><a id="1272" href="V3.TypeChecker.html#1272" class="Bound">Γ</a> <a id="1274" class="Symbol">:</a> <a id="1276" href="V3.WellTypedSyntax.html#255" class="Function">Cxt</a><a id="1279" class="Symbol">}</a> <a id="1281" class="Symbol">(</a><a id="1282" href="V3.TypeChecker.html#1282" class="Bound">γ</a> <a id="1284" class="Symbol">:</a> <a id="1286" href="V3.TypeChecker.html#364" class="Function">TCCxt</a> <a id="1292" href="V3.TypeChecker.html#1272" class="Bound">Γ</a><a id="1293" class="Symbol">)</a> <a id="1295" class="Symbol">(</a><a id="1296" href="V3.TypeChecker.html#1296" class="Bound">x</a> <a id="1298" class="Symbol">:</a> <a id="1300" href="V3.TypeChecker.html#245" class="Function">Name</a><a id="1304" class="Symbol">)</a>
          <a id="1316" class="Symbol">→</a> <a id="1318" href="Library.Error.html#170" class="Function">Error</a> <a id="1324" class="Symbol">(</a><a id="1325" href="Agda.Builtin.Sigma.html#139" class="Record">Σ</a> <a id="1327" href="V3.AST.html#372" class="Datatype">Type</a> <a id="1332" class="Symbol">(λ</a> <a id="1335" href="V3.TypeChecker.html#1335" class="Bound">t</a> <a id="1337" class="Symbol">→</a> <a id="1339" href="V3.WellTypedSyntax.html#277" class="Datatype">Var</a> <a id="1343" href="V3.TypeChecker.html#1272" class="Bound">Γ</a> <a id="1345" href="V3.TypeChecker.html#1335" class="Bound">t</a><a id="1346" class="Symbol">))</a>
<a id="1349" href="V3.TypeChecker.html#1259" class="Function">lookupVar</a> <a id="1359" class="Symbol">{</a><a id="1360" href="Agda.Builtin.List.html#158" class="InductiveConstructor">[]</a><a id="1362" class="Symbol">}</a>    <a id="1367" href="Data.List.Relation.Unary.All.html#1239" class="InductiveConstructor">[]</a>       <a id="1376" href="V3.TypeChecker.html#1376" class="Bound">x</a> <a id="1378" class="Symbol">=</a> <a id="1380" href="Library.Error.html#912" class="Function">throwError</a> <a id="1391" href="Function.html#1645" class="Function Operator">$</a> <a id="1393" href="V3.TypeChecker.html#711" class="InductiveConstructor">unboundVariable</a> <a id="1409" href="V3.TypeChecker.html#1376" class="Bound">x</a>
<a id="1411" href="V3.TypeChecker.html#1259" class="Function">lookupVar</a> <a id="1421" class="Symbol">{</a><a id="1422" href="V3.TypeChecker.html#1422" class="Bound">t</a> <a id="1424" href="Agda.Builtin.List.html#173" class="InductiveConstructor Operator">∷</a> <a id="1426" href="V3.TypeChecker.html#1426" class="Bound">Γ</a><a id="1427" class="Symbol">}</a> <a id="1429" class="Symbol">(</a><a id="1430" href="V3.TypeChecker.html#1430" class="Bound">x&#39;</a> <a id="1433" href="Data.List.Relation.Unary.All.html#1256" class="InductiveConstructor Operator">∷</a> <a id="1435" href="V3.TypeChecker.html#1435" class="Bound">γ</a><a id="1436" class="Symbol">)</a> <a id="1438" href="V3.TypeChecker.html#1438" class="Bound">x</a> <a id="1440" class="Symbol">=</a> <a id="1442" href="Function.html#3662" class="Function Operator">case</a> <a id="1447" href="V3.TypeChecker.html#1438" class="Bound">x</a> <a id="1449" href="Library.Eq.html#627" class="Field Operator">≟</a> <a id="1451" href="V3.TypeChecker.html#1430" class="Bound">x&#39;</a> <a id="1454" href="Function.html#3662" class="Function Operator">of</a> <a id="1457" class="Symbol">λ</a> <a id="1459" class="Keyword">where</a>
  <a id="1467" class="Symbol">(</a><a id="1468" href="Relation.Nullary.html#641" class="InductiveConstructor">yes</a> <a id="1472" href="Agda.Builtin.Equality.html#182" class="InductiveConstructor">refl</a><a id="1476" class="Symbol">)</a> <a id="1478" class="Symbol">→</a> <a id="1480" href="Library.Error.html#268" class="InductiveConstructor">ok</a> <a id="1483" class="Symbol">(</a><a id="1484" href="V3.TypeChecker.html#1422" class="Bound">t</a> <a id="1486" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="1488" href="V3.WellTypedSyntax.html#318" class="InductiveConstructor">here</a><a id="1492" class="Symbol">)</a>
  <a id="1496" class="Symbol">(</a><a id="1497" href="Relation.Nullary.html#668" class="InductiveConstructor">no</a> <a id="1500" class="Symbol">_)</a>     <a id="1507" class="Symbol">→</a> <a id="1509" href="Function.html#3662" class="Function Operator">case</a> <a id="1514" href="V3.TypeChecker.html#1259" class="Function">lookupVar</a> <a id="1524" href="V3.TypeChecker.html#1435" class="Bound">γ</a> <a id="1526" href="V3.TypeChecker.html#1438" class="Bound">x</a> <a id="1528" href="Function.html#3662" class="Function Operator">of</a> <a id="1531" class="Symbol">λ</a> <a id="1533" class="Keyword">where</a>
    <a id="1543" class="Symbol">(</a><a id="1544" href="Library.Error.html#268" class="InductiveConstructor">ok</a> <a id="1547" class="Symbol">(</a><a id="1548" href="V3.TypeChecker.html#1548" class="Bound">t</a> <a id="1550" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="1552" href="V3.TypeChecker.html#1552" class="Bound">i</a><a id="1553" class="Symbol">))</a> <a id="1556" class="Symbol">→</a> <a id="1558" href="Library.Error.html#268" class="InductiveConstructor">ok</a> <a id="1561" class="Symbol">(</a><a id="1562" href="V3.TypeChecker.html#1548" class="Bound">t</a> <a id="1564" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="1566" href="V3.WellTypedSyntax.html#352" class="InductiveConstructor">there</a> <a id="1572" href="V3.TypeChecker.html#1552" class="Bound">i</a><a id="1573" class="Symbol">)</a>
    <a id="1579" class="Symbol">(</a><a id="1580" href="Library.Error.html#238" class="InductiveConstructor">fail</a> <a id="1585" href="V3.TypeChecker.html#1585" class="Bound">err</a><a id="1588" class="Symbol">)</a>   <a id="1592" class="Symbol">→</a> <a id="1594" href="Library.Error.html#238" class="InductiveConstructor">fail</a> <a id="1599" href="V3.TypeChecker.html#1585" class="Bound">err</a>


<a id="1605" class="Comment">-- Checking expressions</a>
<a id="1629" class="Comment">---------------------------------------------------------------------------</a>

<a id="1706" class="Comment">-- During checking of expressions, the context is fixed.</a>

<a id="1764" class="Keyword">module</a> <a id="CheckExpressions"></a><a id="1771" href="V3.TypeChecker.html#1771" class="Module">CheckExpressions</a> <a id="1788" class="Symbol">{</a><a id="1789" href="V3.TypeChecker.html#1789" class="Bound">Γ</a> <a id="1791" class="Symbol">:</a> <a id="1793" href="V3.WellTypedSyntax.html#255" class="Function">Cxt</a><a id="1796" class="Symbol">}</a> <a id="1798" class="Symbol">(</a><a id="1799" href="V3.TypeChecker.html#1799" class="Bound">γ</a> <a id="1801" class="Symbol">:</a> <a id="1803" href="V3.TypeChecker.html#364" class="Function">TCCxt</a> <a id="1809" href="V3.TypeChecker.html#1789" class="Bound">Γ</a><a id="1810" class="Symbol">)</a> <a id="1812" class="Keyword">where</a>

  <a id="1821" class="Comment">-- The expression checker.</a>

  <a id="1851" class="Keyword">mutual</a>

    <a id="1863" class="Comment">-- Type inference.</a>

    <a id="CheckExpressions.inferExp"></a><a id="1887" href="V3.TypeChecker.html#1887" class="Function">inferExp</a> <a id="1896" class="Symbol">:</a> <a id="1898" class="Symbol">(</a><a id="1899" href="V3.TypeChecker.html#1899" class="Bound">e</a> <a id="1901" class="Symbol">:</a> <a id="1903" href="V3.AST.html#584" class="Datatype">A.Exp</a><a id="1908" class="Symbol">)</a> <a id="1910" class="Symbol">→</a> <a id="1912" href="Library.Error.html#170" class="Function">Error</a> <a id="1918" class="Symbol">(</a><a id="1919" href="Agda.Builtin.Sigma.html#139" class="Record">Σ</a> <a id="1921" href="V3.AST.html#372" class="Datatype">Type</a> <a id="1926" class="Symbol">(λ</a> <a id="1929" href="V3.TypeChecker.html#1929" class="Bound">t</a> <a id="1931" class="Symbol">→</a> <a id="1933" href="V3.WellTypedSyntax.html#582" class="Datatype">Exp</a> <a id="1937" href="V3.TypeChecker.html#1789" class="Bound">Γ</a> <a id="1939" href="V3.TypeChecker.html#1929" class="Bound">t</a><a id="1940" class="Symbol">))</a>

    <a id="1948" href="V3.TypeChecker.html#1887" class="Function">inferExp</a> <a id="1957" class="Symbol">(</a><a id="1958" href="V3.AST.html#647" class="InductiveConstructor">A.eInt</a> <a id="1965" href="V3.TypeChecker.html#1965" class="Bound">i</a><a id="1966" class="Symbol">)</a>  <a id="1969" class="Symbol">=</a> <a id="1971" href="Library.Monad.html#1110" class="Function">return</a> <a id="1978" class="Symbol">(</a><a id="1979" href="V3.AST.html#396" class="InductiveConstructor">int</a>  <a id="1984" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="1986" href="V3.WellTypedSyntax.html#632" class="InductiveConstructor">eInt</a>  <a id="1992" href="V3.TypeChecker.html#1965" class="Bound">i</a><a id="1993" class="Symbol">)</a>
    <a id="1999" href="V3.TypeChecker.html#1887" class="Function">inferExp</a> <a id="2008" class="Symbol">(</a><a id="2009" href="V3.AST.html#692" class="InductiveConstructor">A.eBool</a> <a id="2017" href="V3.TypeChecker.html#2017" class="Bound">b</a><a id="2018" class="Symbol">)</a> <a id="2020" class="Symbol">=</a> <a id="2022" href="Library.Monad.html#1110" class="Function">return</a> <a id="2029" class="Symbol">(</a><a id="2030" href="V3.AST.html#391" class="InductiveConstructor">bool</a> <a id="2035" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="2037" href="V3.WellTypedSyntax.html#694" class="InductiveConstructor">eBool</a> <a id="2043" href="V3.TypeChecker.html#2017" class="Bound">b</a><a id="2044" class="Symbol">)</a>

    <a id="2051" href="V3.TypeChecker.html#1887" class="Function">inferExp</a> <a id="2060" class="Symbol">(</a><a id="2061" href="V3.AST.html#602" class="InductiveConstructor">A.eId</a> <a id="2067" href="V3.TypeChecker.html#2067" class="Bound">x</a><a id="2068" class="Symbol">)</a> <a id="2070" class="Symbol">=</a> <a id="2072" class="Keyword">do</a>
      <a id="2081" class="Symbol">(</a><a id="2082" href="V3.TypeChecker.html#2082" class="Bound">t</a> <a id="2084" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="2086" href="V3.TypeChecker.html#2086" class="Bound">x&#39;</a><a id="2088" class="Symbol">)</a> <a id="2090" href="Library.Monad.html#1002" class="Field Operator">←</a> <a id="2092" href="V3.TypeChecker.html#1259" class="Function">lookupVar</a> <a id="2102" href="V3.TypeChecker.html#1799" class="Bound">γ</a> <a id="2104" class="Symbol">(</a><a id="2105" href="V3.TypeChecker.html#260" class="Function">idToName</a> <a id="2114" href="V3.TypeChecker.html#2067" class="Bound">x</a><a id="2115" class="Symbol">)</a>
      <a id="2123" href="Library.Monad.html#1110" class="Function">return</a> <a id="2130" class="Symbol">(</a><a id="2131" href="V3.TypeChecker.html#2082" class="Bound">t</a> <a id="2133" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="2135" href="V3.WellTypedSyntax.html#850" class="InductiveConstructor">eVar</a> <a id="2140" href="V3.TypeChecker.html#2086" class="Bound">x&#39;</a><a id="2142" class="Symbol">)</a>

    <a id="2149" href="V3.TypeChecker.html#1887" class="Function">inferExp</a> <a id="2158" class="Symbol">(</a><a id="2159" href="V3.AST.html#737" class="InductiveConstructor">A.ePlus</a>  <a id="2168" href="V3.TypeChecker.html#2168" class="Bound">e₁</a> <a id="2171" href="V3.TypeChecker.html#2171" class="Bound">e₂</a><a id="2173" class="Symbol">)</a> <a id="2175" class="Symbol">=</a> <a id="2177" href="V3.TypeChecker.html#2643" class="Function">inferOp</a> <a id="2185" href="V3.WellTypedSyntax.html#464" class="InductiveConstructor">plus</a>  <a id="2191" href="V3.TypeChecker.html#2168" class="Bound">e₁</a> <a id="2194" href="V3.TypeChecker.html#2171" class="Bound">e₂</a>

    <a id="2202" href="V3.TypeChecker.html#1887" class="Function">inferExp</a> <a id="2211" class="Symbol">(</a><a id="2212" href="V3.AST.html#782" class="InductiveConstructor">A.eGt</a>    <a id="2221" href="V3.TypeChecker.html#2221" class="Bound">e₁</a> <a id="2224" href="V3.TypeChecker.html#2224" class="Bound">e₂</a><a id="2226" class="Symbol">)</a> <a id="2228" class="Symbol">=</a> <a id="2230" href="V3.TypeChecker.html#2643" class="Function">inferOp</a> <a id="2238" href="V3.WellTypedSyntax.html#486" class="InductiveConstructor">gt</a>    <a id="2244" href="V3.TypeChecker.html#2221" class="Bound">e₁</a> <a id="2247" href="V3.TypeChecker.html#2224" class="Bound">e₂</a>

    <a id="2255" href="V3.TypeChecker.html#1887" class="Function">inferExp</a> <a id="2264" class="Symbol">(</a><a id="2265" href="V3.AST.html#827" class="InductiveConstructor">A.eAnd</a>   <a id="2274" href="V3.TypeChecker.html#2274" class="Bound">e₁</a> <a id="2277" href="V3.TypeChecker.html#2277" class="Bound">e₂</a><a id="2279" class="Symbol">)</a> <a id="2281" class="Symbol">=</a> <a id="2283" href="V3.TypeChecker.html#2643" class="Function">inferOp</a> <a id="2291" href="V3.WellTypedSyntax.html#509" class="InductiveConstructor">and</a>   <a id="2297" href="V3.TypeChecker.html#2274" class="Bound">e₁</a> <a id="2300" href="V3.TypeChecker.html#2277" class="Bound">e₂</a>

    <a id="2308" class="Comment">-- Type checking.</a>
    <a id="2330" class="Comment">-- Calls inference and checks inferred type against given type.</a>

    <a id="CheckExpressions.checkExp"></a><a id="2399" href="V3.TypeChecker.html#2399" class="Function">checkExp</a> <a id="2408" class="Symbol">:</a> <a id="2410" class="Symbol">(</a><a id="2411" href="V3.TypeChecker.html#2411" class="Bound">e</a> <a id="2413" class="Symbol">:</a> <a id="2415" href="V3.AST.html#584" class="Datatype">A.Exp</a><a id="2420" class="Symbol">)</a> <a id="2422" class="Symbol">(</a><a id="2423" href="V3.TypeChecker.html#2423" class="Bound">t</a> <a id="2425" class="Symbol">:</a> <a id="2427" href="V3.AST.html#372" class="Datatype">Type</a><a id="2431" class="Symbol">)</a> <a id="2433" class="Symbol">→</a> <a id="2435" href="Library.Error.html#170" class="Function">Error</a> <a id="2441" class="Symbol">(</a><a id="2442" href="V3.WellTypedSyntax.html#582" class="Datatype">Exp</a> <a id="2446" href="V3.TypeChecker.html#1789" class="Bound">Γ</a> <a id="2448" href="V3.TypeChecker.html#2423" class="Bound">t</a><a id="2449" class="Symbol">)</a>
    <a id="2455" href="V3.TypeChecker.html#2399" class="Function">checkExp</a> <a id="2464" href="V3.TypeChecker.html#2464" class="Bound">e</a> <a id="2466" href="V3.TypeChecker.html#2466" class="Bound">t</a> <a id="2468" class="Symbol">=</a> <a id="2470" class="Keyword">do</a>
      <a id="2479" class="Symbol">(</a><a id="2480" href="V3.TypeChecker.html#2480" class="Bound">t&#39;</a> <a id="2483" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="2485" href="V3.TypeChecker.html#2485" class="Bound">e&#39;</a><a id="2487" class="Symbol">)</a> <a id="2489" href="Library.Monad.html#1002" class="Field Operator">←</a> <a id="2491" href="V3.TypeChecker.html#1887" class="Function">inferExp</a> <a id="2500" href="V3.TypeChecker.html#2464" class="Bound">e</a>
      <a id="2508" href="Function.html#3662" class="Function Operator">case</a> <a id="2513" href="V3.TypeChecker.html#2480" class="Bound">t&#39;</a> <a id="2516" href="Library.Eq.html#627" class="Field Operator">≟</a> <a id="2518" href="V3.TypeChecker.html#2466" class="Bound">t</a> <a id="2520" href="Function.html#3662" class="Function Operator">of</a> <a id="2523" class="Symbol">λ</a> <a id="2525" class="Keyword">where</a>
        <a id="2539" class="Symbol">(</a><a id="2540" href="Relation.Nullary.html#641" class="InductiveConstructor">yes</a> <a id="2544" href="Agda.Builtin.Equality.html#182" class="InductiveConstructor">refl</a><a id="2548" class="Symbol">)</a> <a id="2550" class="Symbol">→</a> <a id="2552" href="Library.Monad.html#1110" class="Function">return</a> <a id="2559" href="V3.TypeChecker.html#2485" class="Bound">e&#39;</a>
        <a id="2570" class="Symbol">(</a><a id="2571" href="Relation.Nullary.html#668" class="InductiveConstructor">no</a>  <a id="2575" href="V3.TypeChecker.html#2575" class="Bound">t&#39;≢t</a><a id="2579" class="Symbol">)</a> <a id="2581" class="Symbol">→</a> <a id="2583" href="Library.Error.html#912" class="Function">throwError</a> <a id="2594" class="Symbol">(</a><a id="2595" href="V3.TypeChecker.html#755" class="InductiveConstructor">typeMismatch</a> <a id="2608" href="V3.TypeChecker.html#2480" class="Bound">t&#39;</a> <a id="2611" href="V3.TypeChecker.html#2466" class="Bound">t</a> <a id="2613" href="V3.TypeChecker.html#2575" class="Bound">t&#39;≢t</a><a id="2617" class="Symbol">)</a>

    <a id="2624" class="Comment">-- Operators.</a>

    <a id="CheckExpressions.inferOp"></a><a id="2643" href="V3.TypeChecker.html#2643" class="Function">inferOp</a> <a id="2651" class="Symbol">:</a> <a id="2653" class="Symbol">∀{</a><a id="2655" href="V3.TypeChecker.html#2655" class="Bound">t</a> <a id="2657" href="V3.TypeChecker.html#2657" class="Bound">t&#39;</a><a id="2659" class="Symbol">}</a> <a id="2661" class="Symbol">(</a><a id="2662" href="V3.TypeChecker.html#2662" class="Bound">op</a> <a id="2665" class="Symbol">:</a> <a id="2667" href="V3.WellTypedSyntax.html#426" class="Datatype">Op</a> <a id="2670" href="V3.TypeChecker.html#2655" class="Bound">t</a> <a id="2672" href="V3.TypeChecker.html#2657" class="Bound">t&#39;</a><a id="2674" class="Symbol">)</a> <a id="2676" class="Symbol">(</a><a id="2677" href="V3.TypeChecker.html#2677" class="Bound">e₁</a> <a id="2680" href="V3.TypeChecker.html#2680" class="Bound">e₂</a> <a id="2683" class="Symbol">:</a> <a id="2685" href="V3.AST.html#584" class="Datatype">A.Exp</a><a id="2690" class="Symbol">)</a> <a id="2692" class="Symbol">→</a> <a id="2694" href="Library.Error.html#170" class="Function">Error</a> <a id="2700" class="Symbol">(</a><a id="2701" href="Agda.Builtin.Sigma.html#139" class="Record">Σ</a> <a id="2703" href="V3.AST.html#372" class="Datatype">Type</a> <a id="2708" class="Symbol">(λ</a> <a id="2711" href="V3.TypeChecker.html#2711" class="Bound">t</a> <a id="2713" class="Symbol">→</a> <a id="2715" href="V3.WellTypedSyntax.html#582" class="Datatype">Exp</a> <a id="2719" href="V3.TypeChecker.html#1789" class="Bound">Γ</a> <a id="2721" href="V3.TypeChecker.html#2711" class="Bound">t</a><a id="2722" class="Symbol">))</a>
    <a id="2729" href="V3.TypeChecker.html#2643" class="Function">inferOp</a> <a id="2737" class="Symbol">{</a><a id="2738" href="V3.TypeChecker.html#2738" class="Bound">t</a><a id="2739" class="Symbol">}</a> <a id="2741" class="Symbol">{</a><a id="2742" href="V3.TypeChecker.html#2742" class="Bound">t&#39;</a><a id="2744" class="Symbol">}</a> <a id="2746" href="V3.TypeChecker.html#2746" class="Bound">op</a> <a id="2749" href="V3.TypeChecker.html#2749" class="Bound">e₁</a> <a id="2752" href="V3.TypeChecker.html#2752" class="Bound">e₂</a> <a id="2755" class="Symbol">=</a> <a id="2757" class="Keyword">do</a>
      <a id="2766" href="V3.TypeChecker.html#2766" class="Bound">e₁&#39;</a> <a id="2770" href="Library.Monad.html#1002" class="Field Operator">←</a> <a id="2772" href="V3.TypeChecker.html#2399" class="Function">checkExp</a> <a id="2781" href="V3.TypeChecker.html#2749" class="Bound">e₁</a> <a id="2784" href="V3.TypeChecker.html#2738" class="Bound">t</a>
      <a id="2792" href="V3.TypeChecker.html#2792" class="Bound">e₂&#39;</a> <a id="2796" href="Library.Monad.html#1002" class="Field Operator">←</a> <a id="2798" href="V3.TypeChecker.html#2399" class="Function">checkExp</a> <a id="2807" href="V3.TypeChecker.html#2752" class="Bound">e₂</a> <a id="2810" href="V3.TypeChecker.html#2738" class="Bound">t</a>
      <a id="2818" href="Library.Monad.html#1110" class="Function">return</a> <a id="2825" class="Symbol">(</a><a id="2826" href="V3.TypeChecker.html#2742" class="Bound">t&#39;</a> <a id="2829" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="2831" href="V3.WellTypedSyntax.html#773" class="InductiveConstructor">eOp</a> <a id="2835" href="V3.TypeChecker.html#2746" class="Bound">op</a> <a id="2838" href="V3.TypeChecker.html#2766" class="Bound">e₁&#39;</a> <a id="2842" href="V3.TypeChecker.html#2792" class="Bound">e₂&#39;</a><a id="2845" class="Symbol">)</a>

  <a id="2850" class="Keyword">mutual</a>

    <a id="2862" class="Comment">-- Checking a single statement.</a>

    <a id="CheckExpressions.checkStm"></a><a id="2899" href="V3.TypeChecker.html#2899" class="Function">checkStm</a> <a id="2908" class="Symbol">:</a> <a id="2910" class="Symbol">(</a><a id="2911" href="V3.TypeChecker.html#2911" class="Bound">s</a> <a id="2913" class="Symbol">:</a> <a id="2915" href="V3.AST.html#1154" class="Datatype">A.Stm</a><a id="2920" class="Symbol">)</a> <a id="2922" class="Symbol">→</a> <a id="2924" href="Library.Error.html#170" class="Function">Error</a> <a id="2930" class="Symbol">(</a><a id="2931" href="V3.WellTypedSyntax.html#1209" class="Datatype">Stm</a> <a id="2935" href="V3.TypeChecker.html#1789" class="Bound">Γ</a><a id="2936" class="Symbol">)</a>

    <a id="2943" href="V3.TypeChecker.html#2899" class="Function">checkStm</a> <a id="2952" class="Symbol">(</a><a id="2953" href="V3.AST.html#1172" class="InductiveConstructor">A.sAss</a> <a id="2960" href="V3.TypeChecker.html#2960" class="Bound">x</a> <a id="2962" href="V3.TypeChecker.html#2962" class="Bound">e</a><a id="2963" class="Symbol">)</a> <a id="2965" class="Symbol">=</a> <a id="2967" class="Keyword">do</a>
      <a id="2976" class="Symbol">(</a><a id="2977" href="V3.TypeChecker.html#2977" class="Bound">t</a> <a id="2979" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="2981" href="V3.TypeChecker.html#2981" class="Bound">x&#39;</a><a id="2983" class="Symbol">)</a> <a id="2985" href="Library.Monad.html#1002" class="Field Operator">←</a> <a id="2987" href="V3.TypeChecker.html#1259" class="Function">lookupVar</a> <a id="2997" href="V3.TypeChecker.html#1799" class="Bound">γ</a> <a id="2999" class="Symbol">(</a><a id="3000" href="V3.TypeChecker.html#260" class="Function">idToName</a> <a id="3009" href="V3.TypeChecker.html#2960" class="Bound">x</a><a id="3010" class="Symbol">)</a>
      <a id="3018" href="V3.TypeChecker.html#3018" class="Bound">e&#39;</a> <a id="3021" href="Library.Monad.html#1002" class="Field Operator">←</a> <a id="3023" href="V3.TypeChecker.html#2399" class="Function">checkExp</a> <a id="3032" href="V3.TypeChecker.html#2962" class="Bound">e</a> <a id="3034" href="V3.TypeChecker.html#2977" class="Bound">t</a>
      <a id="3042" href="Library.Monad.html#1110" class="Function">return</a> <a id="3049" class="Symbol">(</a><a id="3050" href="V3.WellTypedSyntax.html#1239" class="InductiveConstructor">sAss</a> <a id="3055" href="V3.TypeChecker.html#2981" class="Bound">x&#39;</a> <a id="3058" href="V3.TypeChecker.html#3018" class="Bound">e&#39;</a><a id="3060" class="Symbol">)</a>

    <a id="3067" href="V3.TypeChecker.html#2899" class="Function">checkStm</a> <a id="3076" class="Symbol">(</a><a id="3077" href="V3.AST.html#1220" class="InductiveConstructor">A.sWhile</a> <a id="3086" href="V3.TypeChecker.html#3086" class="Bound">e</a> <a id="3088" href="V3.TypeChecker.html#3088" class="Bound">ss</a><a id="3090" class="Symbol">)</a> <a id="3092" class="Symbol">=</a> <a id="3094" class="Keyword">do</a>
      <a id="3103" href="V3.TypeChecker.html#3103" class="Bound">e&#39;</a>  <a id="3107" href="Library.Monad.html#1002" class="Field Operator">←</a> <a id="3109" href="V3.TypeChecker.html#2399" class="Function">checkExp</a> <a id="3118" href="V3.TypeChecker.html#3086" class="Bound">e</a> <a id="3120" href="V3.AST.html#391" class="InductiveConstructor">bool</a>
      <a id="3131" href="V3.TypeChecker.html#3131" class="Bound">ss&#39;</a> <a id="3135" href="Library.Monad.html#1002" class="Field Operator">←</a> <a id="3137" href="V3.TypeChecker.html#3223" class="Function">checkStms</a> <a id="3147" href="V3.TypeChecker.html#3088" class="Bound">ss</a>
      <a id="3156" href="Library.Monad.html#1110" class="Function">return</a> <a id="3163" class="Symbol">(</a><a id="3164" href="V3.WellTypedSyntax.html#1308" class="InductiveConstructor">sWhile</a> <a id="3171" href="V3.TypeChecker.html#3103" class="Bound">e&#39;</a> <a id="3174" href="V3.TypeChecker.html#3131" class="Bound">ss&#39;</a><a id="3177" class="Symbol">)</a>

    <a id="3184" class="Comment">-- Checking a list of statements.</a>

    <a id="CheckExpressions.checkStms"></a><a id="3223" href="V3.TypeChecker.html#3223" class="Function">checkStms</a> <a id="3233" class="Symbol">:</a> <a id="3235" class="Symbol">(</a><a id="3236" href="V3.TypeChecker.html#3236" class="Bound">ss</a> <a id="3239" class="Symbol">:</a> <a id="3241" href="Agda.Builtin.List.html#121" class="Datatype">List</a> <a id="3246" href="V3.AST.html#1154" class="Datatype">A.Stm</a><a id="3251" class="Symbol">)</a> <a id="3253" class="Symbol">→</a> <a id="3255" href="Library.Error.html#170" class="Function">Error</a> <a id="3261" class="Symbol">(</a><a id="3262" href="V3.WellTypedSyntax.html#1445" class="Function">Stms</a> <a id="3267" href="V3.TypeChecker.html#1789" class="Bound">Γ</a><a id="3268" class="Symbol">)</a>
    <a id="3274" href="V3.TypeChecker.html#3223" class="Function">checkStms</a> <a id="3284" href="Agda.Builtin.List.html#158" class="InductiveConstructor">[]</a>       <a id="3293" class="Symbol">=</a> <a id="3295" href="Library.Monad.html#1110" class="Function">return</a> <a id="3302" href="Agda.Builtin.List.html#158" class="InductiveConstructor">[]</a>
    <a id="3309" href="V3.TypeChecker.html#3223" class="Function">checkStms</a> <a id="3319" class="Symbol">(</a><a id="3320" href="V3.TypeChecker.html#3320" class="Bound">s</a> <a id="3322" href="Agda.Builtin.List.html#173" class="InductiveConstructor Operator">∷</a> <a id="3324" href="V3.TypeChecker.html#3324" class="Bound">ss</a><a id="3326" class="Symbol">)</a> <a id="3328" class="Symbol">=</a> <a id="3330" class="Keyword">do</a>
      <a id="3339" href="V3.TypeChecker.html#3339" class="Bound">s&#39;</a> <a id="3342" href="Library.Monad.html#1002" class="Field Operator">←</a> <a id="3344" href="V3.TypeChecker.html#2899" class="Function">checkStm</a> <a id="3353" href="V3.TypeChecker.html#3320" class="Bound">s</a>
      <a id="3361" class="Symbol">(</a><a id="3362" href="V3.TypeChecker.html#3339" class="Bound">s&#39;</a> <a id="3365" href="Agda.Builtin.List.html#173" class="InductiveConstructor Operator">∷_</a><a id="3367" class="Symbol">)</a> <a id="3369" href="Library.Monad.html#284" class="Function Operator">&lt;$&gt;</a> <a id="3373" href="V3.TypeChecker.html#3223" class="Function">checkStms</a> <a id="3383" href="V3.TypeChecker.html#3324" class="Bound">ss</a>

<a id="3387" class="Comment">-- The declaration checker calls the expression checker.</a>
<a id="3444" class="Comment">-- Exported interface of expression checker:</a>

<a id="3490" class="Comment">-- Monad for checking expressions</a>

<a id="3525" class="Keyword">record</a> <a id="TCExp"></a><a id="3532" href="V3.TypeChecker.html#3532" class="Record">TCExp</a> <a id="3538" href="V3.TypeChecker.html#3538" class="Bound">Γ</a> <a id="3540" class="Symbol">(</a><a id="3541" href="V3.TypeChecker.html#3541" class="Bound">A</a> <a id="3543" class="Symbol">:</a> <a id="3545" class="PrimitiveType">Set</a><a id="3548" class="Symbol">)</a> <a id="3550" class="Symbol">:</a> <a id="3552" class="PrimitiveType">Set</a> <a id="3556" class="Keyword">where</a>
  <a id="3564" class="Keyword">field</a>
    <a id="TCExp.runTCExp"></a><a id="3574" href="V3.TypeChecker.html#3574" class="Field">runTCExp</a> <a id="3583" class="Symbol">:</a> <a id="3585" href="V3.TypeChecker.html#364" class="Function">TCCxt</a> <a id="3591" href="V3.TypeChecker.html#3538" class="Bound">Γ</a> <a id="3593" class="Symbol">→</a> <a id="3595" href="Library.Error.html#170" class="Function">Error</a> <a id="3601" href="V3.TypeChecker.html#3541" class="Bound">A</a>
<a id="3603" class="Keyword">open</a> <a id="3608" href="V3.TypeChecker.html#3532" class="Module">TCExp</a>

<a id="checkExp"></a><a id="3615" href="V3.TypeChecker.html#3615" class="Function">checkExp</a> <a id="3624" class="Symbol">:</a> <a id="3626" class="Symbol">∀{</a><a id="3628" href="V3.TypeChecker.html#3628" class="Bound">Γ</a><a id="3629" class="Symbol">}</a> <a id="3631" class="Symbol">(</a><a id="3632" href="V3.TypeChecker.html#3632" class="Bound">e</a> <a id="3634" class="Symbol">:</a> <a id="3636" href="V3.AST.html#584" class="Datatype">A.Exp</a><a id="3641" class="Symbol">)</a> <a id="3643" class="Symbol">(</a><a id="3644" href="V3.TypeChecker.html#3644" class="Bound">t</a> <a id="3646" class="Symbol">:</a> <a id="3648" href="V3.AST.html#372" class="Datatype">Type</a><a id="3652" class="Symbol">)</a> <a id="3654" class="Symbol">→</a> <a id="3656" href="V3.TypeChecker.html#3532" class="Record">TCExp</a> <a id="3662" href="V3.TypeChecker.html#3628" class="Bound">Γ</a> <a id="3664" class="Symbol">(</a><a id="3665" href="V3.WellTypedSyntax.html#582" class="Datatype">Exp</a> <a id="3669" href="V3.TypeChecker.html#3628" class="Bound">Γ</a> <a id="3671" href="V3.TypeChecker.html#3644" class="Bound">t</a><a id="3672" class="Symbol">)</a>
<a id="3674" href="V3.TypeChecker.html#3615" class="Function">checkExp</a> <a id="3683" href="V3.TypeChecker.html#3683" class="Bound">e</a> <a id="3685" href="V3.TypeChecker.html#3685" class="Bound">t</a> <a id="3687" class="Symbol">.</a><a id="3688" href="V3.TypeChecker.html#3574" class="Field">runTCExp</a> <a id="3697" href="V3.TypeChecker.html#3697" class="Bound">γ</a> <a id="3699" class="Symbol">=</a> <a id="3701" href="V3.TypeChecker.html#2399" class="Function">CheckExpressions.checkExp</a> <a id="3727" href="V3.TypeChecker.html#3697" class="Bound">γ</a> <a id="3729" href="V3.TypeChecker.html#3683" class="Bound">e</a> <a id="3731" href="V3.TypeChecker.html#3685" class="Bound">t</a>

<a id="checkStms"></a><a id="3734" href="V3.TypeChecker.html#3734" class="Function">checkStms</a> <a id="3744" class="Symbol">:</a> <a id="3746" class="Symbol">∀{</a><a id="3748" href="V3.TypeChecker.html#3748" class="Bound">Γ</a><a id="3749" class="Symbol">}</a> <a id="3751" class="Symbol">(</a><a id="3752" href="V3.TypeChecker.html#3752" class="Bound">ss</a> <a id="3755" class="Symbol">:</a> <a id="3757" href="Agda.Builtin.List.html#121" class="Datatype">List</a> <a id="3762" href="V3.AST.html#1154" class="Datatype">A.Stm</a><a id="3767" class="Symbol">)</a> <a id="3769" class="Symbol">→</a> <a id="3771" href="V3.TypeChecker.html#3532" class="Record">TCExp</a> <a id="3777" href="V3.TypeChecker.html#3748" class="Bound">Γ</a> <a id="3779" class="Symbol">(</a><a id="3780" href="V3.WellTypedSyntax.html#1445" class="Function">Stms</a> <a id="3785" href="V3.TypeChecker.html#3748" class="Bound">Γ</a><a id="3786" class="Symbol">)</a>
<a id="3788" href="V3.TypeChecker.html#3734" class="Function">checkStms</a> <a id="3798" href="V3.TypeChecker.html#3798" class="Bound">ss</a> <a id="3801" class="Symbol">.</a><a id="3802" href="V3.TypeChecker.html#3574" class="Field">runTCExp</a> <a id="3811" href="V3.TypeChecker.html#3811" class="Bound">γ</a> <a id="3813" class="Symbol">=</a> <a id="3815" href="V3.TypeChecker.html#3223" class="Function">CheckExpressions.checkStms</a> <a id="3842" href="V3.TypeChecker.html#3811" class="Bound">γ</a> <a id="3844" href="V3.TypeChecker.html#3798" class="Bound">ss</a>

<a id="3848" class="Comment">-- Checking declarations.</a>
<a id="3874" class="Comment">---------------------------------------------------------------------------</a>

<a id="3951" class="Comment">-- Monad for checking declarations.</a>

<a id="3988" class="Comment">-- Variable declarations can be inserted into the top block, thus,</a>
<a id="4055" class="Comment">-- we need to treat the top block as mutable state.</a>

<a id="4108" class="Keyword">record</a> <a id="TCDecl"></a><a id="4115" href="V3.TypeChecker.html#4115" class="Record">TCDecl</a> <a id="4122" href="V3.TypeChecker.html#4122" class="Bound">Γ</a> <a id="4124" href="V3.TypeChecker.html#4124" class="Bound">Γ&#39;</a> <a id="4127" class="Symbol">(</a><a id="4128" href="V3.TypeChecker.html#4128" class="Bound">A</a> <a id="4130" class="Symbol">:</a> <a id="4132" class="PrimitiveType">Set</a><a id="4135" class="Symbol">)</a> <a id="4137" class="Symbol">:</a> <a id="4139" class="PrimitiveType">Set</a> <a id="4143" class="Keyword">where</a>
  <a id="4151" class="Keyword">field</a>
    <a id="TCDecl.runTCDecl"></a><a id="4161" href="V3.TypeChecker.html#4161" class="Field">runTCDecl</a> <a id="4171" class="Symbol">:</a> <a id="4173" href="V3.TypeChecker.html#364" class="Function">TCCxt</a> <a id="4179" href="V3.TypeChecker.html#4122" class="Bound">Γ</a> <a id="4181" class="Symbol">→</a> <a id="4183" href="Library.Error.html#170" class="Function">Error</a> <a id="4189" class="Symbol">(</a><a id="4190" href="V3.TypeChecker.html#4128" class="Bound">A</a> <a id="4192" href="Data.Product.html#1162" class="Function Operator">×</a> <a id="4194" href="V3.TypeChecker.html#364" class="Function">TCCxt</a> <a id="4200" href="V3.TypeChecker.html#4124" class="Bound">Γ&#39;</a><a id="4202" class="Symbol">)</a>
<a id="4204" class="Keyword">open</a> <a id="4209" href="V3.TypeChecker.html#4115" class="Module">TCDecl</a>

<a id="4217" class="Keyword">module</a> <a id="CheckDeclarations"></a><a id="4224" href="V3.TypeChecker.html#4224" class="Module">CheckDeclarations</a> <a id="4242" class="Keyword">where</a>

  <a id="4251" class="Comment">-- TCDecl is a monad.</a>

  <a id="4276" class="Keyword">private</a>

    <a id="CheckDeclarations.returnTCDecl"></a><a id="4289" href="V3.TypeChecker.html#4289" class="Function">returnTCDecl</a> <a id="4302" class="Symbol">:</a> <a id="4304" class="Symbol">∀</a> <a id="4306" class="Symbol">{</a><a id="4307" href="V3.TypeChecker.html#4307" class="Bound">Γ</a> <a id="4309" href="V3.TypeChecker.html#4309" class="Bound">A</a><a id="4310" class="Symbol">}</a> <a id="4312" class="Symbol">(</a><a id="4313" href="V3.TypeChecker.html#4313" class="Bound">a</a> <a id="4315" class="Symbol">:</a> <a id="4317" href="V3.TypeChecker.html#4309" class="Bound">A</a><a id="4318" class="Symbol">)</a> <a id="4320" class="Symbol">→</a> <a id="4322" href="V3.TypeChecker.html#4115" class="Record">TCDecl</a> <a id="4329" href="V3.TypeChecker.html#4307" class="Bound">Γ</a> <a id="4331" href="V3.TypeChecker.html#4307" class="Bound">Γ</a> <a id="4333" href="V3.TypeChecker.html#4309" class="Bound">A</a>
    <a id="4339" href="V3.TypeChecker.html#4289" class="Function">returnTCDecl</a> <a id="4352" href="V3.TypeChecker.html#4352" class="Bound">a</a> <a id="4354" class="Symbol">.</a><a id="4355" href="V3.TypeChecker.html#4161" class="Field">runTCDecl</a> <a id="4365" href="V3.TypeChecker.html#4365" class="Bound">γ</a> <a id="4367" class="Symbol">=</a> <a id="4369" href="Library.Error.html#268" class="InductiveConstructor">ok</a> <a id="4372" class="Symbol">(</a><a id="4373" href="V3.TypeChecker.html#4352" class="Bound">a</a> <a id="4375" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="4377" href="V3.TypeChecker.html#4365" class="Bound">γ</a><a id="4378" class="Symbol">)</a>

    <a id="CheckDeclarations.bindTCDecl"></a><a id="4385" href="V3.TypeChecker.html#4385" class="Function">bindTCDecl</a> <a id="4396" class="Symbol">:</a> <a id="4398" class="Symbol">∀{</a><a id="4400" href="V3.TypeChecker.html#4400" class="Bound">Γ</a> <a id="4402" href="V3.TypeChecker.html#4402" class="Bound">Γ′</a> <a id="4405" href="V3.TypeChecker.html#4405" class="Bound">Γ″</a> <a id="4408" href="V3.TypeChecker.html#4408" class="Bound">A</a> <a id="4410" href="V3.TypeChecker.html#4410" class="Bound">B</a><a id="4411" class="Symbol">}</a>
      <a id="4419" class="Symbol">(</a><a id="4420" href="V3.TypeChecker.html#4420" class="Bound">m</a> <a id="4422" class="Symbol">:</a>     <a id="4428" href="V3.TypeChecker.html#4115" class="Record">TCDecl</a> <a id="4435" href="V3.TypeChecker.html#4400" class="Bound">Γ</a>  <a id="4438" href="V3.TypeChecker.html#4402" class="Bound">Γ′</a> <a id="4441" href="V3.TypeChecker.html#4408" class="Bound">A</a><a id="4442" class="Symbol">)</a>
      <a id="4450" class="Symbol">(</a><a id="4451" href="V3.TypeChecker.html#4451" class="Bound">k</a> <a id="4453" class="Symbol">:</a> <a id="4455" href="V3.TypeChecker.html#4408" class="Bound">A</a> <a id="4457" class="Symbol">→</a> <a id="4459" href="V3.TypeChecker.html#4115" class="Record">TCDecl</a> <a id="4466" href="V3.TypeChecker.html#4402" class="Bound">Γ′</a> <a id="4469" href="V3.TypeChecker.html#4405" class="Bound">Γ″</a> <a id="4472" href="V3.TypeChecker.html#4410" class="Bound">B</a><a id="4473" class="Symbol">)</a>
             <a id="4488" class="Symbol">→</a> <a id="4490" href="V3.TypeChecker.html#4115" class="Record">TCDecl</a> <a id="4497" href="V3.TypeChecker.html#4400" class="Bound">Γ</a>  <a id="4500" href="V3.TypeChecker.html#4405" class="Bound">Γ″</a> <a id="4503" href="V3.TypeChecker.html#4410" class="Bound">B</a>

    <a id="4510" href="V3.TypeChecker.html#4385" class="Function">bindTCDecl</a> <a id="4521" href="V3.TypeChecker.html#4521" class="Bound">m</a> <a id="4523" href="V3.TypeChecker.html#4523" class="Bound">k</a> <a id="4525" class="Symbol">.</a><a id="4526" href="V3.TypeChecker.html#4161" class="Field">runTCDecl</a> <a id="4536" href="V3.TypeChecker.html#4536" class="Bound">γ</a> <a id="4538" class="Symbol">=</a>
      <a id="4546" href="Function.html#3662" class="Function Operator">case</a> <a id="4551" href="V3.TypeChecker.html#4521" class="Bound">m</a> <a id="4553" class="Symbol">.</a><a id="4554" href="V3.TypeChecker.html#4161" class="Field">runTCDecl</a> <a id="4564" href="V3.TypeChecker.html#4536" class="Bound">γ</a> <a id="4566" href="Function.html#3662" class="Function Operator">of</a> <a id="4569" class="Symbol">λ</a> <a id="4571" class="Keyword">where</a>
        <a id="4585" class="Symbol">(</a><a id="4586" href="Library.Error.html#238" class="InductiveConstructor">fail</a> <a id="4591" href="V3.TypeChecker.html#4591" class="Bound">err</a><a id="4594" class="Symbol">)</a>    <a id="4599" class="Symbol">→</a> <a id="4601" href="Library.Error.html#238" class="InductiveConstructor">fail</a> <a id="4606" href="V3.TypeChecker.html#4591" class="Bound">err</a>
        <a id="4618" class="Symbol">(</a><a id="4619" href="Library.Error.html#268" class="InductiveConstructor">ok</a> <a id="4622" class="Symbol">(</a><a id="4623" href="V3.TypeChecker.html#4623" class="Bound">a</a> <a id="4625" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="4627" href="V3.TypeChecker.html#4627" class="Bound">γ&#39;</a><a id="4629" class="Symbol">))</a> <a id="4632" class="Symbol">→</a> <a id="4634" href="V3.TypeChecker.html#4523" class="Bound">k</a> <a id="4636" href="V3.TypeChecker.html#4623" class="Bound">a</a> <a id="4638" class="Symbol">.</a><a id="4639" href="V3.TypeChecker.html#4161" class="Field">runTCDecl</a> <a id="4649" href="V3.TypeChecker.html#4627" class="Bound">γ&#39;</a>


  <a id="4656" class="Keyword">instance</a>
    <a id="CheckDeclarations.functorTCDecl"></a><a id="4669" href="V3.TypeChecker.html#4669" class="Function">functorTCDecl</a> <a id="4683" class="Symbol">:</a> <a id="4685" class="Symbol">∀</a> <a id="4687" class="Symbol">{</a><a id="4688" href="V3.TypeChecker.html#4688" class="Bound">Γ</a> <a id="4690" href="V3.TypeChecker.html#4690" class="Bound">Γ′</a><a id="4692" class="Symbol">}</a> <a id="4694" class="Symbol">→</a> <a id="4696" href="Library.Monad.html#157" class="Record">Functor</a> <a id="4704" class="Symbol">(</a><a id="4705" href="V3.TypeChecker.html#4115" class="Record">TCDecl</a> <a id="4712" href="V3.TypeChecker.html#4688" class="Bound">Γ</a> <a id="4714" href="V3.TypeChecker.html#4690" class="Bound">Γ′</a><a id="4716" class="Symbol">)</a>
    <a id="4722" href="Library.Monad.html#245" class="Field">fmap</a> <a id="4727" class="Symbol">{{</a><a id="4729" href="V3.TypeChecker.html#4669" class="Function">functorTCDecl</a><a id="4742" class="Symbol">}}</a> <a id="4745" href="V3.TypeChecker.html#4745" class="Bound">f</a> <a id="4747" href="V3.TypeChecker.html#4747" class="Bound">m</a> <a id="4749" class="Symbol">=</a> <a id="4751" href="V3.TypeChecker.html#4385" class="Function">bindTCDecl</a> <a id="4762" href="V3.TypeChecker.html#4747" class="Bound">m</a> <a id="4764" class="Symbol">(</a><a id="4765" href="V3.TypeChecker.html#4289" class="Function">returnTCDecl</a> <a id="4778" href="Function.html#3311" class="Function Operator">∘′</a> <a id="4781" href="V3.TypeChecker.html#4745" class="Bound">f</a><a id="4782" class="Symbol">)</a>

    <a id="CheckDeclarations.iApplicativeTCDecl"></a><a id="4789" href="V3.TypeChecker.html#4789" class="Function">iApplicativeTCDecl</a> <a id="4808" class="Symbol">:</a> <a id="4810" href="Library.Monad.html#368" class="Record">IApplicative</a> <a id="4823" href="V3.TypeChecker.html#4115" class="Record">TCDecl</a>
    <a id="4834" href="Library.Monad.html#487" class="Field">pure</a>  <a id="4840" class="Symbol">{{</a><a id="4842" href="V3.TypeChecker.html#4789" class="Function">iApplicativeTCDecl</a><a id="4860" class="Symbol">}}</a>       <a id="4869" class="Symbol">=</a> <a id="4871" href="V3.TypeChecker.html#4289" class="Function">returnTCDecl</a>
    <a id="4888" href="Library.Monad.html#521" class="Field Operator">_&lt;*&gt;_</a> <a id="4894" class="Symbol">{{</a><a id="4896" href="V3.TypeChecker.html#4789" class="Function">iApplicativeTCDecl</a><a id="4914" class="Symbol">}}</a> <a id="4917" href="V3.TypeChecker.html#4917" class="Bound">mf</a> <a id="4920" href="V3.TypeChecker.html#4920" class="Bound">mx</a> <a id="4923" class="Symbol">=</a> <a id="4925" href="V3.TypeChecker.html#4385" class="Function">bindTCDecl</a> <a id="4936" href="V3.TypeChecker.html#4917" class="Bound">mf</a> <a id="4939" class="Symbol">(</a><a id="4940" href="Library.Monad.html#284" class="Function Operator">_&lt;$&gt;</a> <a id="4945" href="V3.TypeChecker.html#4920" class="Bound">mx</a><a id="4947" class="Symbol">)</a>

    <a id="CheckDeclarations.iMonadTCDecl"></a><a id="4954" href="V3.TypeChecker.html#4954" class="Function">iMonadTCDecl</a> <a id="4967" class="Symbol">:</a> <a id="4969" href="Library.Monad.html#867" class="Record">IMonad</a> <a id="4976" href="V3.TypeChecker.html#4115" class="Record">TCDecl</a>
    <a id="4987" href="Library.Monad.html#1002" class="Field Operator">_&gt;&gt;=_</a> <a id="4993" class="Symbol">{{</a><a id="4995" href="V3.TypeChecker.html#4954" class="Function">iMonadTCDecl</a><a id="5007" class="Symbol">}}</a> <a id="5010" class="Symbol">=</a> <a id="5012" href="V3.TypeChecker.html#4385" class="Function">bindTCDecl</a>

  <a id="5026" class="Comment">-- Lifting a TCExp computation into TCDecl.</a>

  <a id="CheckDeclarations.lift"></a><a id="5073" href="V3.TypeChecker.html#5073" class="Function">lift</a> <a id="5078" class="Symbol">:</a> <a id="5080" class="Symbol">∀{</a><a id="5082" href="V3.TypeChecker.html#5082" class="Bound">Γ</a> <a id="5084" href="V3.TypeChecker.html#5084" class="Bound">A</a><a id="5085" class="Symbol">}</a> <a id="5087" class="Symbol">(</a><a id="5088" href="V3.TypeChecker.html#5088" class="Bound">m</a> <a id="5090" class="Symbol">:</a> <a id="5092" href="V3.TypeChecker.html#3532" class="Record">TCExp</a> <a id="5098" href="V3.TypeChecker.html#5082" class="Bound">Γ</a> <a id="5100" href="V3.TypeChecker.html#5084" class="Bound">A</a><a id="5101" class="Symbol">)</a> <a id="5103" class="Symbol">→</a> <a id="5105" href="V3.TypeChecker.html#4115" class="Record">TCDecl</a> <a id="5112" href="V3.TypeChecker.html#5082" class="Bound">Γ</a> <a id="5114" href="V3.TypeChecker.html#5082" class="Bound">Γ</a> <a id="5116" href="V3.TypeChecker.html#5084" class="Bound">A</a>
  <a id="5120" href="V3.TypeChecker.html#5073" class="Function">lift</a> <a id="5125" href="V3.TypeChecker.html#5125" class="Bound">m</a> <a id="5127" class="Symbol">.</a><a id="5128" href="V3.TypeChecker.html#4161" class="Field">runTCDecl</a> <a id="5138" href="V3.TypeChecker.html#5138" class="Bound">γ</a> <a id="5140" class="Symbol">=</a>
    <a id="5146" href="Function.html#3662" class="Function Operator">case</a> <a id="5151" href="V3.TypeChecker.html#5125" class="Bound">m</a> <a id="5153" class="Symbol">.</a><a id="5154" href="V3.TypeChecker.html#3574" class="Field">runTCExp</a> <a id="5163" href="V3.TypeChecker.html#5138" class="Bound">γ</a> <a id="5165" href="Function.html#3662" class="Function Operator">of</a> <a id="5168" class="Symbol">λ</a> <a id="5170" class="Keyword">where</a>
      <a id="5182" class="Symbol">(</a><a id="5183" href="Library.Error.html#238" class="InductiveConstructor">fail</a> <a id="5188" href="V3.TypeChecker.html#5188" class="Bound">err</a><a id="5191" class="Symbol">)</a> <a id="5193" class="Symbol">→</a> <a id="5195" href="Library.Error.html#238" class="InductiveConstructor">fail</a> <a id="5200" href="V3.TypeChecker.html#5188" class="Bound">err</a>
      <a id="5210" class="Symbol">(</a><a id="5211" href="Library.Error.html#268" class="InductiveConstructor">ok</a> <a id="5214" href="V3.TypeChecker.html#5214" class="Bound">a</a><a id="5215" class="Symbol">)</a>     <a id="5221" class="Symbol">→</a> <a id="5223" href="Library.Error.html#268" class="InductiveConstructor">ok</a> <a id="5226" class="Symbol">(</a><a id="5227" href="V3.TypeChecker.html#5214" class="Bound">a</a> <a id="5229" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="5231" href="V3.TypeChecker.html#5138" class="Bound">γ</a><a id="5232" class="Symbol">)</a>

  <a id="5237" class="Comment">-- Add a variable declaration.</a>

  <a id="CheckDeclarations.addVar"></a><a id="5271" href="V3.TypeChecker.html#5271" class="Function">addVar</a> <a id="5278" class="Symbol">:</a> <a id="5280" class="Symbol">∀{</a><a id="5282" href="V3.TypeChecker.html#5282" class="Bound">Γ</a><a id="5283" class="Symbol">}</a> <a id="5285" class="Symbol">(</a><a id="5286" href="V3.TypeChecker.html#5286" class="Bound">x</a> <a id="5288" class="Symbol">:</a> <a id="5290" href="V3.TypeChecker.html#245" class="Function">Name</a><a id="5294" class="Symbol">)</a> <a id="5296" href="V3.TypeChecker.html#5296" class="Bound">t</a> <a id="5298" class="Symbol">→</a> <a id="5300" href="V3.TypeChecker.html#4115" class="Record">TCDecl</a> <a id="5307" href="V3.TypeChecker.html#5282" class="Bound">Γ</a> <a id="5309" class="Symbol">(</a><a id="5310" href="V3.TypeChecker.html#5296" class="Bound">t</a> <a id="5312" href="Agda.Builtin.List.html#173" class="InductiveConstructor Operator">∷</a> <a id="5314" href="V3.TypeChecker.html#5282" class="Bound">Γ</a><a id="5315" class="Symbol">)</a> <a id="5317" href="Agda.Builtin.Unit.html#137" class="Record">⊤</a>
  <a id="5321" href="V3.TypeChecker.html#5271" class="Function">addVar</a> <a id="5328" class="Symbol">{</a><a id="5329" class="Argument">Γ</a> <a id="5331" class="Symbol">=</a> <a id="5333" href="V3.TypeChecker.html#5333" class="Bound">Γ</a><a id="5334" class="Symbol">}</a> <a id="5336" href="V3.TypeChecker.html#5336" class="Bound">x</a> <a id="5338" href="V3.TypeChecker.html#5338" class="Bound">t</a> <a id="5340" class="Symbol">.</a><a id="5341" href="V3.TypeChecker.html#4161" class="Field">runTCDecl</a> <a id="5351" href="V3.TypeChecker.html#5351" class="Bound">γ</a> <a id="5353" class="Symbol">=</a> <a id="5355" href="Library.Error.html#268" class="InductiveConstructor">ok</a> <a id="5358" class="Symbol">(_</a> <a id="5361" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="5363" class="Symbol">(</a><a id="5364" href="V3.TypeChecker.html#5338" class="Bound">t</a> <a id="5366" href="Library.List.html#627" class="Function Operator">↦</a> <a id="5368" href="V3.TypeChecker.html#5336" class="Bound">x</a> <a id="5370" href="Library.List.html#627" class="Function Operator">∷</a> <a id="5372" href="V3.TypeChecker.html#5351" class="Bound">γ</a><a id="5373" class="Symbol">))</a>

  <a id="5379" class="Comment">-- Predicting the next shape of the context.</a>

  <a id="CheckDeclarations.Next"></a><a id="5427" href="V3.TypeChecker.html#5427" class="Function">Next</a> <a id="5432" class="Symbol">:</a> <a id="5434" class="Symbol">(</a><a id="5435" href="V3.TypeChecker.html#5435" class="Bound">Γ</a> <a id="5437" class="Symbol">:</a> <a id="5439" href="V3.WellTypedSyntax.html#255" class="Function">Cxt</a><a id="5442" class="Symbol">)</a> <a id="5444" class="Symbol">(</a><a id="5445" href="V3.TypeChecker.html#5445" class="Bound">s</a> <a id="5447" class="Symbol">:</a> <a id="5449" href="V3.AST.html#973" class="Record">A.Decl</a><a id="5455" class="Symbol">)</a> <a id="5457" class="Symbol">→</a> <a id="5459" href="V3.WellTypedSyntax.html#255" class="Function">Cxt</a>
  <a id="5465" href="V3.TypeChecker.html#5427" class="Function">Next</a> <a id="5470" href="V3.TypeChecker.html#5470" class="Bound">Γ</a> <a id="5472" href="V3.TypeChecker.html#5472" class="Bound">s</a> <a id="5474" class="Symbol">=</a> <a id="5476" href="V3.AST.html#1018" class="Field">A.declType</a> <a id="5487" href="V3.TypeChecker.html#5472" class="Bound">s</a> <a id="5489" href="Agda.Builtin.List.html#173" class="InductiveConstructor Operator">∷</a> <a id="5491" href="V3.TypeChecker.html#5470" class="Bound">Γ</a>

  <a id="CheckDeclarations.Nexts"></a><a id="5496" href="V3.TypeChecker.html#5496" class="Function">Nexts</a> <a id="5502" class="Symbol">:</a> <a id="5504" class="Symbol">(</a><a id="5505" href="V3.TypeChecker.html#5505" class="Bound">Γ</a> <a id="5507" class="Symbol">:</a> <a id="5509" href="V3.WellTypedSyntax.html#255" class="Function">Cxt</a><a id="5512" class="Symbol">)</a> <a id="5514" class="Symbol">(</a><a id="5515" href="V3.TypeChecker.html#5515" class="Bound">ss</a> <a id="5518" class="Symbol">:</a> <a id="5520" href="Agda.Builtin.List.html#121" class="Datatype">List</a> <a id="5525" href="V3.AST.html#973" class="Record">A.Decl</a><a id="5531" class="Symbol">)</a> <a id="5533" class="Symbol">→</a> <a id="5535" href="V3.WellTypedSyntax.html#255" class="Function">Cxt</a>
  <a id="5541" href="V3.TypeChecker.html#5496" class="Function">Nexts</a> <a id="5547" class="Symbol">=</a> <a id="5549" href="Data.List.Base.html#3533" class="Function">foldl</a> <a id="5555" href="V3.TypeChecker.html#5427" class="Function">Next</a>

  <a id="5563" class="Keyword">mutual</a>

    <a id="5575" class="Comment">-- Checking a single declaration.</a>

    <a id="CheckDeclarations.checkDecl"></a><a id="5614" href="V3.TypeChecker.html#5614" class="Function">checkDecl</a> <a id="5624" class="Symbol">:</a> <a id="5626" class="Symbol">∀</a> <a id="5628" class="Symbol">{</a><a id="5629" href="V3.TypeChecker.html#5629" class="Bound">Γ</a><a id="5630" class="Symbol">}</a> <a id="5632" class="Symbol">(</a><a id="5633" href="V3.TypeChecker.html#5633" class="Bound">d</a> <a id="5635" class="Symbol">:</a> <a id="5637" href="V3.AST.html#973" class="Record">A.Decl</a><a id="5643" class="Symbol">)</a> <a id="5645" class="Symbol">(</a><a id="5646" class="Keyword">let</a> <a id="5650" href="V3.TypeChecker.html#5650" class="Bound">t</a> <a id="5652" class="Symbol">=</a> <a id="5654" href="V3.AST.html#1018" class="Field">A.declType</a> <a id="5665" href="V3.TypeChecker.html#5633" class="Bound">d</a><a id="5666" class="Symbol">)</a>
      <a id="5674" class="Symbol">→</a> <a id="5676" href="V3.TypeChecker.html#4115" class="Record">TCDecl</a> <a id="5683" href="V3.TypeChecker.html#5629" class="Bound">Γ</a> <a id="5685" class="Symbol">(</a><a id="5686" href="V3.TypeChecker.html#5650" class="Bound">t</a> <a id="5688" href="Agda.Builtin.List.html#173" class="InductiveConstructor Operator">∷</a> <a id="5690" href="V3.TypeChecker.html#5629" class="Bound">Γ</a><a id="5691" class="Symbol">)</a> <a id="5693" class="Symbol">(</a><a id="5694" href="V3.WellTypedSyntax.html#967" class="Datatype">Decl</a> <a id="5699" href="V3.TypeChecker.html#5629" class="Bound">Γ</a> <a id="5701" href="V3.TypeChecker.html#5650" class="Bound">t</a><a id="5702" class="Symbol">)</a>

    <a id="5709" href="V3.TypeChecker.html#5614" class="Function">checkDecl</a> <a id="5719" class="Symbol">(</a><a id="5720" href="V3.AST.html#1004" class="InductiveConstructor">A.dInit</a> <a id="5728" href="V3.TypeChecker.html#5728" class="Bound">t</a> <a id="5730" href="V3.TypeChecker.html#5730" class="Bound">x</a> <a id="5732" href="V3.TypeChecker.html#5732" class="Bound">e</a><a id="5733" class="Symbol">)</a> <a id="5735" class="Symbol">=</a> <a id="5737" class="Keyword">do</a>
      <a id="5746" href="V3.TypeChecker.html#5746" class="Bound">e&#39;</a> <a id="5749" href="Library.Monad.html#1002" class="Field Operator">←</a> <a id="5751" href="V3.TypeChecker.html#5073" class="Function">lift</a> <a id="5756" href="Function.html#1645" class="Function Operator">$</a> <a id="5758" href="V3.TypeChecker.html#3615" class="Function">checkExp</a> <a id="5767" href="V3.TypeChecker.html#5732" class="Bound">e</a> <a id="5769" href="V3.TypeChecker.html#5728" class="Bound">t</a>
      <a id="5777" href="V3.TypeChecker.html#5271" class="Function">addVar</a> <a id="5784" class="Symbol">(</a><a id="5785" href="V3.TypeChecker.html#260" class="Function">idToName</a> <a id="5794" href="V3.TypeChecker.html#5730" class="Bound">x</a><a id="5795" class="Symbol">)</a> <a id="5797" href="V3.TypeChecker.html#5728" class="Bound">t</a>
      <a id="5805" href="Library.Monad.html#1110" class="Function">return</a> <a id="5812" class="Symbol">(</a><a id="5813" href="V3.WellTypedSyntax.html#1007" class="InductiveConstructor">dInit</a> <a id="5819" href="V3.TypeChecker.html#5746" class="Bound">e&#39;</a><a id="5821" class="Symbol">)</a>

    <a id="5828" class="Comment">-- Checking a list of declarations.</a>

    <a id="CheckDeclarations.checkDecls"></a><a id="5869" href="V3.TypeChecker.html#5869" class="Function">checkDecls</a> <a id="5880" class="Symbol">:</a> <a id="5882" class="Symbol">∀</a> <a id="5884" class="Symbol">{</a><a id="5885" href="V3.TypeChecker.html#5885" class="Bound">Γ</a><a id="5886" class="Symbol">}</a> <a id="5888" class="Symbol">(</a><a id="5889" href="V3.TypeChecker.html#5889" class="Bound">ds</a> <a id="5892" class="Symbol">:</a> <a id="5894" href="Agda.Builtin.List.html#121" class="Datatype">List</a> <a id="5899" href="V3.AST.html#973" class="Record">A.Decl</a><a id="5905" class="Symbol">)</a> <a id="5907" class="Symbol">(</a><a id="5908" class="Keyword">let</a> <a id="5912" href="V3.TypeChecker.html#5912" class="Bound">Γ&#39;</a> <a id="5915" class="Symbol">=</a> <a id="5917" href="V3.TypeChecker.html#5496" class="Function">Nexts</a> <a id="5923" href="V3.TypeChecker.html#5885" class="Bound">Γ</a> <a id="5925" href="V3.TypeChecker.html#5889" class="Bound">ds</a><a id="5927" class="Symbol">)</a>
      <a id="5935" class="Symbol">→</a> <a id="5937" href="V3.TypeChecker.html#4115" class="Record">TCDecl</a> <a id="5944" href="V3.TypeChecker.html#5885" class="Bound">Γ</a> <a id="5946" href="V3.TypeChecker.html#5912" class="Bound">Γ&#39;</a> <a id="5949" class="Symbol">(</a><a id="5950" href="V3.WellTypedSyntax.html#1046" class="Datatype">Decls</a> <a id="5956" href="V3.TypeChecker.html#5885" class="Bound">Γ</a> <a id="5958" href="V3.TypeChecker.html#5912" class="Bound">Γ&#39;</a><a id="5960" class="Symbol">)</a>

    <a id="5967" href="V3.TypeChecker.html#5869" class="Function">checkDecls</a> <a id="5978" href="Agda.Builtin.List.html#158" class="InductiveConstructor">[]</a>       <a id="5987" class="Symbol">=</a> <a id="5989" href="Library.Monad.html#1110" class="Function">return</a> <a id="5996" href="V3.WellTypedSyntax.html#1082" class="InductiveConstructor">[]</a>
    <a id="6003" href="V3.TypeChecker.html#5869" class="Function">checkDecls</a> <a id="6014" class="Symbol">(</a><a id="6015" href="V3.TypeChecker.html#6015" class="Bound">d</a> <a id="6017" href="Agda.Builtin.List.html#173" class="InductiveConstructor Operator">∷</a> <a id="6019" href="V3.TypeChecker.html#6019" class="Bound">ds</a><a id="6021" class="Symbol">)</a> <a id="6023" class="Symbol">=</a> <a id="6025" class="Keyword">do</a>
      <a id="6034" href="V3.TypeChecker.html#6034" class="Bound">d&#39;</a> <a id="6037" href="Library.Monad.html#1002" class="Field Operator">←</a> <a id="6039" href="V3.TypeChecker.html#5614" class="Function">checkDecl</a> <a id="6049" href="V3.TypeChecker.html#6015" class="Bound">d</a>
      <a id="6057" class="Symbol">(</a><a id="6058" href="V3.TypeChecker.html#6034" class="Bound">d&#39;</a> <a id="6061" href="V3.WellTypedSyntax.html#1100" class="InductiveConstructor Operator">∷_</a><a id="6063" class="Symbol">)</a> <a id="6065" href="Library.Monad.html#284" class="Function Operator">&lt;$&gt;</a> <a id="6069" href="V3.TypeChecker.html#5869" class="Function">checkDecls</a> <a id="6080" href="V3.TypeChecker.html#6019" class="Bound">ds</a>

  <a id="6086" class="Comment">-- Checking the program in TCDecl.</a>

  <a id="CheckDeclarations.checkProgram"></a><a id="6124" href="V3.TypeChecker.html#6124" class="Function">checkProgram</a> <a id="6137" class="Symbol">:</a> <a id="6139" class="Symbol">(</a><a id="6140" href="V3.TypeChecker.html#6140" class="Bound">prg</a> <a id="6144" class="Symbol">:</a> <a id="6146" href="V3.AST.html#1334" class="Record">A.Program</a><a id="6155" class="Symbol">)</a> <a id="6157" class="Symbol">(</a><a id="6158" class="Keyword">let</a> <a id="6162" href="V3.TypeChecker.html#6162" class="Bound">Γ</a> <a id="6164" class="Symbol">=</a> <a id="6166" href="V3.TypeChecker.html#5496" class="Function">Nexts</a> <a id="6172" href="Agda.Builtin.List.html#158" class="InductiveConstructor">[]</a> <a id="6175" class="Symbol">(</a><a id="6176" href="V3.AST.html#1388" class="Field">A.theDecls</a> <a id="6187" href="V3.TypeChecker.html#6140" class="Bound">prg</a><a id="6190" class="Symbol">))</a>
    <a id="6197" class="Symbol">→</a> <a id="6199" href="V3.TypeChecker.html#4115" class="Record">TCDecl</a> <a id="6206" href="Agda.Builtin.List.html#158" class="InductiveConstructor">[]</a> <a id="6209" href="V3.TypeChecker.html#6162" class="Bound">Γ</a> <a id="6211" href="V3.WellTypedSyntax.html#1556" class="Record">Program</a>

  <a id="6222" href="V3.TypeChecker.html#6124" class="Function">checkProgram</a> <a id="6235" class="Symbol">(</a><a id="6236" href="V3.AST.html#1368" class="InductiveConstructor">A.program</a> <a id="6246" href="V3.TypeChecker.html#6246" class="Bound">ds</a> <a id="6249" href="V3.TypeChecker.html#6249" class="Bound">ss</a> <a id="6252" href="V3.TypeChecker.html#6252" class="Bound">e</a><a id="6253" class="Symbol">)</a> <a id="6255" class="Symbol">=</a> <a id="6257" class="Keyword">do</a>
    <a id="6264" href="V3.TypeChecker.html#6264" class="Bound">ds&#39;</a> <a id="6268" href="Library.Monad.html#1002" class="Field Operator">←</a> <a id="6270" href="V3.TypeChecker.html#5869" class="Function">checkDecls</a> <a id="6281" href="V3.TypeChecker.html#6246" class="Bound">ds</a>
    <a id="6288" href="V3.TypeChecker.html#6288" class="Bound">ss&#39;</a> <a id="6292" href="Library.Monad.html#1002" class="Field Operator">←</a> <a id="6294" href="V3.TypeChecker.html#5073" class="Function">lift</a> <a id="6299" href="Function.html#1645" class="Function Operator">$</a> <a id="6301" href="V3.TypeChecker.html#3734" class="Function">checkStms</a> <a id="6311" href="V3.TypeChecker.html#6249" class="Bound">ss</a>
    <a id="6318" href="V3.TypeChecker.html#6318" class="Bound">e&#39;</a>  <a id="6322" href="Library.Monad.html#1002" class="Field Operator">←</a> <a id="6324" href="V3.TypeChecker.html#5073" class="Function">lift</a> <a id="6329" href="Function.html#1645" class="Function Operator">$</a> <a id="6331" href="V3.TypeChecker.html#3615" class="Function">checkExp</a> <a id="6340" href="V3.TypeChecker.html#6252" class="Bound">e</a> <a id="6342" href="V3.AST.html#396" class="InductiveConstructor">int</a>
    <a id="6350" href="Library.Monad.html#1110" class="Function">return</a> <a id="6357" class="Symbol">(</a><a id="6358" href="V3.WellTypedSyntax.html#1590" class="InductiveConstructor">program</a> <a id="6366" href="V3.TypeChecker.html#6264" class="Bound">ds&#39;</a> <a id="6370" href="V3.TypeChecker.html#6288" class="Bound">ss&#39;</a> <a id="6374" href="V3.TypeChecker.html#6318" class="Bound">e&#39;</a><a id="6376" class="Symbol">)</a>

<a id="6379" class="Comment">-- Checking the program.</a>
<a id="6404" class="Comment">---------------------------------------------------------------------------</a>

<a id="checkProgram"></a><a id="6481" href="V3.TypeChecker.html#6481" class="Function">checkProgram</a> <a id="6494" class="Symbol">:</a> <a id="6496" class="Symbol">(</a><a id="6497" href="V3.TypeChecker.html#6497" class="Bound">prg</a> <a id="6501" class="Symbol">:</a> <a id="6503" href="V3.AST.html#1334" class="Record">A.Program</a><a id="6512" class="Symbol">)</a> <a id="6514" class="Symbol">→</a> <a id="6516" href="Library.Error.html#170" class="Function">Error</a> <a id="6522" href="V3.WellTypedSyntax.html#1556" class="Record">Program</a>
<a id="6530" href="V3.TypeChecker.html#6481" class="Function">checkProgram</a> <a id="6543" href="V3.TypeChecker.html#6543" class="Bound">prg</a> <a id="6547" class="Symbol">=</a> <a id="6549" href="Agda.Builtin.Sigma.html#225" class="Field">proj₁</a> <a id="6555" href="Library.Monad.html#284" class="Function Operator">&lt;$&gt;</a> <a id="6559" href="V3.TypeChecker.html#6124" class="Function">CheckDeclarations.checkProgram</a> <a id="6590" href="V3.TypeChecker.html#6543" class="Bound">prg</a> <a id="6594" class="Symbol">.</a><a id="6595" href="V3.TypeChecker.html#4161" class="Field">runTCDecl</a> <a id="6605" href="Data.List.Relation.Unary.All.html#1239" class="InductiveConstructor">[]</a>


<a id="6610" class="Comment">-- -}</a>
<a id="6616" class="Comment">-- -}</a>
<a id="6622" class="Comment">-- -}</a>
<a id="6628" class="Comment">-- -}</a>
<a id="6634" class="Comment">-- -}</a>
<a id="6640" class="Comment">-- -}</a>
</pre></body></html>