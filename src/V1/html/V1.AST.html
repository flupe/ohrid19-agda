<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>V1.AST</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Comment">-- Agda definition of C-- abstract syntax trees</a>
<a id="49" class="Comment">-- and Haskell bindings to the ones generated by the parser.</a>

<a id="111" class="Keyword">module</a> <a id="118" href="V1.AST.html" class="Module">V1.AST</a> <a id="125" class="Keyword">where</a>

<a id="132" class="Keyword">open</a> <a id="137" class="Keyword">import</a> <a id="144" href="Library.html" class="Module">Library</a>

<a id="153" class="Symbol">{-#</a> <a id="157" class="Keyword">FOREIGN</a> <a id="165" class="Pragma">GHC</a> <a id="169" class="Pragma">import</a> <a id="176" class="Pragma">qualified</a> <a id="186" class="Pragma">Data.Text</a> <a id="196" class="Symbol">#-}</a>
<a id="200" class="Symbol">{-#</a> <a id="204" class="Keyword">FOREIGN</a> <a id="212" class="Pragma">GHC</a> <a id="216" class="Pragma">import</a> <a id="223" class="Pragma">While.Abs</a> <a id="233" class="Symbol">#-}</a>
<a id="237" class="Symbol">{-#</a> <a id="241" class="Keyword">FOREIGN</a> <a id="249" class="Pragma">GHC</a> <a id="253" class="Pragma">import</a> <a id="260" class="Pragma">While.Print</a> <a id="272" class="Symbol">#-}</a>

<a id="277" class="Keyword">data</a> <a id="Type"></a><a id="282" href="V1.AST.html#282" class="Datatype">Type</a> <a id="287" class="Symbol">:</a> <a id="289" class="PrimitiveType">Set</a> <a id="293" class="Keyword">where</a>
  <a id="Type.bool"></a><a id="301" href="V1.AST.html#301" class="InductiveConstructor">bool</a> <a id="Type.int"></a><a id="306" href="V1.AST.html#306" class="InductiveConstructor">int</a> <a id="310" class="Symbol">:</a> <a id="312" href="V1.AST.html#282" class="Datatype">Type</a>

<a id="318" class="Symbol">{-#</a> <a id="322" class="Keyword">COMPILE</a> <a id="330" class="Pragma">GHC</a> <a id="334" href="V1.AST.html#282" class="Datatype">Type</a> <a id="339" class="Pragma">=</a> <a id="341" class="Pragma">data</a> <a id="346" class="Pragma">Type</a>
  <a id="353" class="Pragma">(</a> <a id="355" class="Pragma">TBool</a>
  <a id="363" class="Pragma">|</a> <a id="365" class="Pragma">TInt</a>
  <a id="372" class="Pragma">)</a> <a id="374" class="Symbol">#-}</a>

<a id="379" class="Keyword">data</a> <a id="Boolean"></a><a id="384" href="V1.AST.html#384" class="Datatype">Boolean</a> <a id="392" class="Symbol">:</a> <a id="394" class="PrimitiveType">Set</a> <a id="398" class="Keyword">where</a>
  <a id="Boolean.true"></a><a id="406" href="V1.AST.html#406" class="InductiveConstructor">true</a> <a id="Boolean.false"></a><a id="411" href="V1.AST.html#411" class="InductiveConstructor">false</a> <a id="417" class="Symbol">:</a> <a id="419" href="V1.AST.html#384" class="Datatype">Boolean</a>

<a id="428" class="Symbol">{-#</a> <a id="432" class="Keyword">COMPILE</a> <a id="440" class="Pragma">GHC</a> <a id="444" href="V1.AST.html#384" class="Datatype">Boolean</a> <a id="452" class="Pragma">=</a> <a id="454" class="Pragma">data</a> <a id="459" class="Pragma">Boolean</a> <a id="467" class="Pragma">(BTrue</a> <a id="474" class="Pragma">|</a> <a id="476" class="Pragma">BFalse)</a> <a id="484" class="Symbol">#-}</a>

<a id="489" class="Keyword">data</a> <a id="Exp"></a><a id="494" href="V1.AST.html#494" class="Datatype">Exp</a> <a id="498" class="Symbol">:</a> <a id="500" class="PrimitiveType">Set</a> <a id="504" class="Keyword">where</a>
  <a id="Exp.eInt"></a><a id="512" href="V1.AST.html#512" class="InductiveConstructor">eInt</a>   <a id="519" class="Symbol">:</a> <a id="521" class="Symbol">(</a><a id="522" href="V1.AST.html#522" class="Bound">i</a> <a id="524" class="Symbol">:</a> <a id="526" href="Agda.Builtin.Int.html#219" class="Datatype">ℤ</a><a id="527" class="Symbol">)</a>       <a id="535" class="Symbol">→</a> <a id="537" href="V1.AST.html#494" class="Datatype">Exp</a>
  <a id="Exp.eBool"></a><a id="543" href="V1.AST.html#543" class="InductiveConstructor">eBool</a>  <a id="550" class="Symbol">:</a> <a id="552" class="Symbol">(</a><a id="553" href="V1.AST.html#553" class="Bound">b</a> <a id="555" class="Symbol">:</a> <a id="557" href="V1.AST.html#384" class="Datatype">Boolean</a><a id="564" class="Symbol">)</a> <a id="566" class="Symbol">→</a> <a id="568" href="V1.AST.html#494" class="Datatype">Exp</a>
  <a id="Exp.ePlus"></a><a id="574" href="V1.AST.html#574" class="InductiveConstructor">ePlus</a>  <a id="581" class="Symbol">:</a> <a id="583" class="Symbol">(</a><a id="584" href="V1.AST.html#584" class="Bound">e</a> <a id="586" href="V1.AST.html#586" class="Bound">e&#39;</a> <a id="589" class="Symbol">:</a> <a id="591" href="V1.AST.html#494" class="Datatype">Exp</a><a id="594" class="Symbol">)</a>  <a id="597" class="Symbol">→</a> <a id="599" href="V1.AST.html#494" class="Datatype">Exp</a>
  <a id="Exp.eGt"></a><a id="605" href="V1.AST.html#605" class="InductiveConstructor">eGt</a>    <a id="612" class="Symbol">:</a> <a id="614" class="Symbol">(</a><a id="615" href="V1.AST.html#615" class="Bound">e</a> <a id="617" href="V1.AST.html#617" class="Bound">e&#39;</a> <a id="620" class="Symbol">:</a> <a id="622" href="V1.AST.html#494" class="Datatype">Exp</a><a id="625" class="Symbol">)</a>  <a id="628" class="Symbol">→</a> <a id="630" href="V1.AST.html#494" class="Datatype">Exp</a>
  <a id="Exp.eAnd"></a><a id="636" href="V1.AST.html#636" class="InductiveConstructor">eAnd</a>   <a id="643" class="Symbol">:</a> <a id="645" class="Symbol">(</a><a id="646" href="V1.AST.html#646" class="Bound">e</a> <a id="648" href="V1.AST.html#648" class="Bound">e&#39;</a> <a id="651" class="Symbol">:</a> <a id="653" href="V1.AST.html#494" class="Datatype">Exp</a><a id="656" class="Symbol">)</a>  <a id="659" class="Symbol">→</a> <a id="661" href="V1.AST.html#494" class="Datatype">Exp</a>

<a id="666" class="Symbol">{-#</a> <a id="670" class="Keyword">COMPILE</a> <a id="678" class="Pragma">GHC</a> <a id="682" href="V1.AST.html#494" class="Datatype">Exp</a> <a id="686" class="Pragma">=</a> <a id="688" class="Pragma">data</a> <a id="693" class="Pragma">Exp</a>
  <a id="699" class="Pragma">(</a> <a id="701" class="Pragma">EInt</a>
  <a id="708" class="Pragma">|</a> <a id="710" class="Pragma">EBool</a>
  <a id="718" class="Pragma">|</a> <a id="720" class="Pragma">EPlus</a>
  <a id="728" class="Pragma">|</a> <a id="730" class="Pragma">EGt</a>
  <a id="736" class="Pragma">|</a> <a id="738" class="Pragma">EAnd</a>
  <a id="745" class="Pragma">)</a> <a id="747" class="Symbol">#-}</a>

<a id="752" class="Keyword">record</a> <a id="Program"></a><a id="759" href="V1.AST.html#759" class="Record">Program</a> <a id="767" class="Symbol">:</a> <a id="769" class="PrimitiveType">Set</a> <a id="773" class="Keyword">where</a>
  <a id="781" class="Keyword">constructor</a> <a id="Program.program"></a><a id="793" href="V1.AST.html#793" class="InductiveConstructor">program</a>
  <a id="803" class="Keyword">field</a>
    <a id="Program.theMain"></a><a id="813" href="V1.AST.html#813" class="Field">theMain</a>  <a id="822" class="Symbol">:</a> <a id="824" href="V1.AST.html#494" class="Datatype">Exp</a>
<a id="828" class="Keyword">open</a> <a id="833" href="V1.AST.html#759" class="Module">Program</a> <a id="841" class="Keyword">public</a>

<a id="849" class="Symbol">{-#</a> <a id="853" class="Keyword">COMPILE</a> <a id="861" class="Pragma">GHC</a> <a id="865" href="V1.AST.html#759" class="Record">Program</a> <a id="873" class="Pragma">=</a> <a id="875" class="Pragma">data</a> <a id="880" class="Pragma">Program</a> <a id="888" class="Pragma">(Prg)</a> <a id="894" class="Symbol">#-}</a>

<a id="899" class="Comment">-- Pretty printer</a>

<a id="918" class="Keyword">private</a>
  <a id="928" class="Keyword">postulate</a>
    <a id="printType"></a><a id="942" href="V1.AST.html#942" class="Postulate">printType</a>    <a id="955" class="Symbol">:</a> <a id="957" href="V1.AST.html#282" class="Datatype">Type</a>    <a id="965" class="Symbol">→</a> <a id="967" href="Agda.Builtin.String.html#247" class="Postulate">String</a>
    <a id="printBoolean"></a><a id="978" href="V1.AST.html#978" class="Postulate">printBoolean</a> <a id="991" class="Symbol">:</a> <a id="993" href="V1.AST.html#384" class="Datatype">Boolean</a> <a id="1001" class="Symbol">→</a> <a id="1003" href="Agda.Builtin.String.html#247" class="Postulate">String</a>
    <a id="printExp"></a><a id="1014" href="V1.AST.html#1014" class="Postulate">printExp</a>     <a id="1027" class="Symbol">:</a> <a id="1029" href="V1.AST.html#494" class="Datatype">Exp</a>     <a id="1037" class="Symbol">→</a> <a id="1039" href="Agda.Builtin.String.html#247" class="Postulate">String</a>
    <a id="printProgram"></a><a id="1050" href="V1.AST.html#1050" class="Postulate">printProgram</a> <a id="1063" class="Symbol">:</a> <a id="1065" href="V1.AST.html#759" class="Record">Program</a> <a id="1073" class="Symbol">→</a> <a id="1075" href="Agda.Builtin.String.html#247" class="Postulate">String</a>

<a id="1083" class="Symbol">{-#</a> <a id="1087" class="Keyword">COMPILE</a> <a id="1095" class="Pragma">GHC</a> <a id="1099" href="V1.AST.html#942" class="Postulate">printType</a>    <a id="1112" class="Pragma">=</a> <a id="1114" class="Pragma">\</a> <a id="1116" class="Pragma">t</a> <a id="1118" class="Pragma">-&gt;</a> <a id="1121" class="Pragma">Data.Text.pack</a> <a id="1136" class="Pragma">(printTree</a> <a id="1147" class="Pragma">(t</a> <a id="1150" class="Pragma">::</a> <a id="1153" class="Pragma">Type))</a>    <a id="1163" class="Symbol">#-}</a>
<a id="1167" class="Symbol">{-#</a> <a id="1171" class="Keyword">COMPILE</a> <a id="1179" class="Pragma">GHC</a> <a id="1183" href="V1.AST.html#978" class="Postulate">printBoolean</a> <a id="1196" class="Pragma">=</a> <a id="1198" class="Pragma">\</a> <a id="1200" class="Pragma">b</a> <a id="1202" class="Pragma">-&gt;</a> <a id="1205" class="Pragma">Data.Text.pack</a> <a id="1220" class="Pragma">(printTree</a> <a id="1231" class="Pragma">(b</a> <a id="1234" class="Pragma">::</a> <a id="1237" class="Pragma">Boolean))</a> <a id="1247" class="Symbol">#-}</a>
<a id="1251" class="Symbol">{-#</a> <a id="1255" class="Keyword">COMPILE</a> <a id="1263" class="Pragma">GHC</a> <a id="1267" href="V1.AST.html#1014" class="Postulate">printExp</a>     <a id="1280" class="Pragma">=</a> <a id="1282" class="Pragma">\</a> <a id="1284" class="Pragma">e</a> <a id="1286" class="Pragma">-&gt;</a> <a id="1289" class="Pragma">Data.Text.pack</a> <a id="1304" class="Pragma">(printTree</a> <a id="1315" class="Pragma">(e</a> <a id="1318" class="Pragma">::</a> <a id="1321" class="Pragma">Exp))</a>     <a id="1331" class="Symbol">#-}</a>
<a id="1335" class="Symbol">{-#</a> <a id="1339" class="Keyword">COMPILE</a> <a id="1347" class="Pragma">GHC</a> <a id="1351" href="V1.AST.html#1050" class="Postulate">printProgram</a> <a id="1364" class="Pragma">=</a> <a id="1366" class="Pragma">\</a> <a id="1368" class="Pragma">p</a> <a id="1370" class="Pragma">-&gt;</a> <a id="1373" class="Pragma">Data.Text.pack</a> <a id="1388" class="Pragma">(printTree</a> <a id="1399" class="Pragma">(p</a> <a id="1402" class="Pragma">::</a> <a id="1405" class="Pragma">Program))</a> <a id="1415" class="Symbol">#-}</a>

<a id="1420" class="Keyword">instance</a>
  <a id="PrintType"></a><a id="1431" href="V1.AST.html#1431" class="Function">PrintType</a> <a id="1441" class="Symbol">:</a> <a id="1443" href="Library.Print.html#196" class="Record">Print</a> <a id="1449" href="V1.AST.html#282" class="Datatype">Type</a>
  <a id="1456" href="Library.Print.html#244" class="Field">print</a> <a id="1462" class="Symbol">{{</a><a id="1464" href="V1.AST.html#1431" class="Function">PrintType</a><a id="1473" class="Symbol">}}</a> <a id="1476" class="Symbol">=</a> <a id="1478" href="V1.AST.html#942" class="Postulate">printType</a>

  <a id="PrintBoolean"></a><a id="1491" href="V1.AST.html#1491" class="Function">PrintBoolean</a> <a id="1504" class="Symbol">:</a> <a id="1506" href="Library.Print.html#196" class="Record">Print</a> <a id="1512" href="V1.AST.html#384" class="Datatype">Boolean</a>
  <a id="1522" href="Library.Print.html#244" class="Field">print</a> <a id="1528" class="Symbol">{{</a><a id="1530" href="V1.AST.html#1491" class="Function">PrintBoolean</a><a id="1542" class="Symbol">}}</a> <a id="1545" class="Symbol">=</a> <a id="1547" href="V1.AST.html#978" class="Postulate">printBoolean</a>

  <a id="PrintExp"></a><a id="1563" href="V1.AST.html#1563" class="Function">PrintExp</a> <a id="1572" class="Symbol">:</a> <a id="1574" href="Library.Print.html#196" class="Record">Print</a> <a id="1580" href="V1.AST.html#494" class="Datatype">Exp</a>
  <a id="1586" href="Library.Print.html#244" class="Field">print</a> <a id="1592" class="Symbol">{{</a><a id="1594" href="V1.AST.html#1563" class="Function">PrintExp</a><a id="1602" class="Symbol">}}</a> <a id="1605" class="Symbol">=</a> <a id="1607" href="V1.AST.html#1014" class="Postulate">printExp</a>

  <a id="PrintProgram"></a><a id="1619" href="V1.AST.html#1619" class="Function">PrintProgram</a> <a id="1632" class="Symbol">:</a> <a id="1634" href="Library.Print.html#196" class="Record">Print</a> <a id="1640" href="V1.AST.html#759" class="Record">Program</a>
  <a id="1650" href="Library.Print.html#244" class="Field">print</a> <a id="1656" class="Symbol">{{</a><a id="1658" href="V1.AST.html#1619" class="Function">PrintProgram</a><a id="1670" class="Symbol">}}</a> <a id="1673" class="Symbol">=</a> <a id="1675" href="V1.AST.html#1050" class="Postulate">printProgram</a>

<a id="1689" class="Comment">-- Eq instance</a>

<a id="1705" class="Keyword">instance</a>
  <a id="EqType"></a><a id="1716" href="V1.AST.html#1716" class="Function">EqType</a> <a id="1723" class="Symbol">:</a> <a id="1725" href="Library.Eq.html#610" class="Record">Eq</a> <a id="1728" href="V1.AST.html#282" class="Datatype">Type</a>
  <a id="1735" href="Library.Eq.html#655" class="Field Operator">_≟_</a> <a id="1739" class="Symbol">{{</a><a id="1741" href="V1.AST.html#1716" class="Function">EqType</a><a id="1747" class="Symbol">}}</a> <a id="1750" class="Symbol">=</a> <a id="1752" class="Symbol">λ</a> <a id="1754" class="Keyword">where</a>
    <a id="1764" href="V1.AST.html#301" class="InductiveConstructor">bool</a> <a id="1769" href="V1.AST.html#301" class="InductiveConstructor">bool</a> <a id="1774" class="Symbol">→</a> <a id="1776" href="Relation.Nullary.html#641" class="InductiveConstructor">yes</a> <a id="1780" href="Agda.Builtin.Equality.html#182" class="InductiveConstructor">refl</a>
    <a id="1789" href="V1.AST.html#301" class="InductiveConstructor">bool</a> <a id="1794" href="V1.AST.html#306" class="InductiveConstructor">int</a>  <a id="1799" class="Symbol">→</a> <a id="1801" href="Relation.Nullary.html#668" class="InductiveConstructor">no</a> <a id="1804" class="Symbol">λ</a> <a id="1806" class="Symbol">()</a>
    <a id="1813" href="V1.AST.html#306" class="InductiveConstructor">int</a>  <a id="1818" href="V1.AST.html#301" class="InductiveConstructor">bool</a> <a id="1823" class="Symbol">→</a> <a id="1825" href="Relation.Nullary.html#668" class="InductiveConstructor">no</a> <a id="1828" class="Symbol">λ</a> <a id="1830" class="Symbol">()</a>
    <a id="1837" href="V1.AST.html#306" class="InductiveConstructor">int</a>  <a id="1842" href="V1.AST.html#306" class="InductiveConstructor">int</a>  <a id="1847" class="Symbol">→</a> <a id="1849" href="Relation.Nullary.html#641" class="InductiveConstructor">yes</a> <a id="1853" href="Agda.Builtin.Equality.html#182" class="InductiveConstructor">refl</a>
</pre></body></html>