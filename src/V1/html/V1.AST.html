<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>V1.AST</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Comment">-- Agda definition of C-- abstract syntax trees</a>
<a id="49" class="Comment">-- and Haskell bindings to the ones generated by the parser.</a>

<a id="111" class="Keyword">module</a> <a id="118" href="V1.AST.html" class="Module">V1.AST</a> <a id="125" class="Keyword">where</a>

<a id="132" class="Keyword">open</a> <a id="137" class="Keyword">import</a> <a id="144" href="Library.html" class="Module">Library</a>

<a id="153" class="Symbol">{-#</a> <a id="157" class="Keyword">FOREIGN</a> <a id="165" class="Pragma">GHC</a> <a id="169" class="Pragma">import</a> <a id="176" class="Pragma">qualified</a> <a id="186" class="Pragma">Data.Text</a> <a id="196" class="Symbol">#-}</a>
<a id="200" class="Symbol">{-#</a> <a id="204" class="Keyword">FOREIGN</a> <a id="212" class="Pragma">GHC</a> <a id="216" class="Pragma">import</a> <a id="223" class="Pragma">While.Abs</a> <a id="233" class="Symbol">#-}</a>
<a id="237" class="Symbol">{-#</a> <a id="241" class="Keyword">FOREIGN</a> <a id="249" class="Pragma">GHC</a> <a id="253" class="Pragma">import</a> <a id="260" class="Pragma">While.Print</a> <a id="272" class="Symbol">#-}</a>

<a id="277" class="Keyword">data</a> <a id="Type"></a><a id="282" href="V1.AST.html#282" class="Datatype">Type</a> <a id="287" class="Symbol">:</a> <a id="289" class="PrimitiveType">Set</a> <a id="293" class="Keyword">where</a>
  <a id="Type.bool"></a><a id="301" href="V1.AST.html#301" class="InductiveConstructor">bool</a> <a id="Type.int"></a><a id="306" href="V1.AST.html#306" class="InductiveConstructor">int</a> <a id="310" class="Symbol">:</a> <a id="312" href="V1.AST.html#282" class="Datatype">Type</a>

<a id="318" class="Symbol">{-#</a> <a id="322" class="Keyword">COMPILE</a> <a id="330" class="Pragma">GHC</a> <a id="334" href="V1.AST.html#282" class="Datatype">Type</a> <a id="339" class="Pragma">=</a> <a id="341" class="Pragma">data</a> <a id="346" class="Pragma">Type</a>
  <a id="353" class="Pragma">(</a> <a id="355" class="Pragma">TBool</a>
  <a id="363" class="Pragma">|</a> <a id="365" class="Pragma">TInt</a>
  <a id="372" class="Pragma">)</a> <a id="374" class="Symbol">#-}</a>

<a id="379" class="Keyword">data</a> <a id="Boolean"></a><a id="384" href="V1.AST.html#384" class="Datatype">Boolean</a> <a id="392" class="Symbol">:</a> <a id="394" class="PrimitiveType">Set</a> <a id="398" class="Keyword">where</a>
  <a id="Boolean.true"></a><a id="406" href="V1.AST.html#406" class="InductiveConstructor">true</a> <a id="Boolean.false"></a><a id="411" href="V1.AST.html#411" class="InductiveConstructor">false</a> <a id="417" class="Symbol">:</a> <a id="419" href="V1.AST.html#384" class="Datatype">Boolean</a>

<a id="428" class="Symbol">{-#</a> <a id="432" class="Keyword">COMPILE</a> <a id="440" class="Pragma">GHC</a> <a id="444" href="V1.AST.html#384" class="Datatype">Boolean</a> <a id="452" class="Pragma">=</a> <a id="454" class="Pragma">data</a> <a id="459" class="Pragma">Boolean</a> <a id="467" class="Pragma">(BTrue</a> <a id="474" class="Pragma">|</a> <a id="476" class="Pragma">BFalse)</a> <a id="484" class="Symbol">#-}</a>

<a id="489" class="Keyword">data</a> <a id="Exp"></a><a id="494" href="V1.AST.html#494" class="Datatype">Exp</a> <a id="498" class="Symbol">:</a> <a id="500" class="PrimitiveType">Set</a> <a id="504" class="Keyword">where</a>
  <a id="Exp.eInt"></a><a id="512" href="V1.AST.html#512" class="InductiveConstructor">eInt</a>      <a id="522" class="Symbol">:</a> <a id="524" class="Symbol">(</a><a id="525" href="V1.AST.html#525" class="Bound">i</a> <a id="527" class="Symbol">:</a> <a id="529" href="Agda.Builtin.Int.html#219" class="Datatype">ℤ</a><a id="530" class="Symbol">)</a>                  <a id="549" class="Symbol">→</a> <a id="551" href="V1.AST.html#494" class="Datatype">Exp</a>
  <a id="Exp.eBool"></a><a id="557" href="V1.AST.html#557" class="InductiveConstructor">eBool</a>     <a id="567" class="Symbol">:</a> <a id="569" class="Symbol">(</a><a id="570" href="V1.AST.html#570" class="Bound">b</a> <a id="572" class="Symbol">:</a> <a id="574" href="V1.AST.html#384" class="Datatype">Boolean</a><a id="581" class="Symbol">)</a>            <a id="594" class="Symbol">→</a> <a id="596" href="V1.AST.html#494" class="Datatype">Exp</a>
  <a id="Exp.ePlus"></a><a id="602" href="V1.AST.html#602" class="InductiveConstructor">ePlus</a>     <a id="612" class="Symbol">:</a> <a id="614" class="Symbol">(</a><a id="615" href="V1.AST.html#615" class="Bound">e</a> <a id="617" href="V1.AST.html#617" class="Bound">e&#39;</a> <a id="620" class="Symbol">:</a> <a id="622" href="V1.AST.html#494" class="Datatype">Exp</a><a id="625" class="Symbol">)</a>             <a id="639" class="Symbol">→</a> <a id="641" href="V1.AST.html#494" class="Datatype">Exp</a>
  <a id="Exp.eGt"></a><a id="647" href="V1.AST.html#647" class="InductiveConstructor">eGt</a>       <a id="657" class="Symbol">:</a> <a id="659" class="Symbol">(</a><a id="660" href="V1.AST.html#660" class="Bound">e</a> <a id="662" href="V1.AST.html#662" class="Bound">e&#39;</a> <a id="665" class="Symbol">:</a> <a id="667" href="V1.AST.html#494" class="Datatype">Exp</a><a id="670" class="Symbol">)</a>             <a id="684" class="Symbol">→</a> <a id="686" href="V1.AST.html#494" class="Datatype">Exp</a>
  <a id="Exp.eAnd"></a><a id="692" href="V1.AST.html#692" class="InductiveConstructor">eAnd</a>      <a id="702" class="Symbol">:</a> <a id="704" class="Symbol">(</a><a id="705" href="V1.AST.html#705" class="Bound">e</a> <a id="707" href="V1.AST.html#707" class="Bound">e&#39;</a> <a id="710" class="Symbol">:</a> <a id="712" href="V1.AST.html#494" class="Datatype">Exp</a><a id="715" class="Symbol">)</a>             <a id="729" class="Symbol">→</a> <a id="731" href="V1.AST.html#494" class="Datatype">Exp</a>


<a id="737" class="Symbol">{-#</a> <a id="741" class="Keyword">COMPILE</a> <a id="749" class="Pragma">GHC</a> <a id="753" href="V1.AST.html#494" class="Datatype">Exp</a> <a id="757" class="Pragma">=</a> <a id="759" class="Pragma">data</a> <a id="764" class="Pragma">Exp</a>
  <a id="770" class="Pragma">(</a> <a id="772" class="Pragma">EInt</a>
  <a id="779" class="Pragma">|</a> <a id="781" class="Pragma">EBool</a>
  <a id="789" class="Pragma">|</a> <a id="791" class="Pragma">EPlus</a>
  <a id="799" class="Pragma">|</a> <a id="801" class="Pragma">EGt</a>
  <a id="807" class="Pragma">|</a> <a id="809" class="Pragma">EAnd</a>
  <a id="816" class="Pragma">)</a> <a id="818" class="Symbol">#-}</a>

<a id="823" class="Keyword">record</a> <a id="Program"></a><a id="830" href="V1.AST.html#830" class="Record">Program</a> <a id="838" class="Symbol">:</a> <a id="840" class="PrimitiveType">Set</a> <a id="844" class="Keyword">where</a>
  <a id="852" class="Keyword">constructor</a> <a id="Program.program"></a><a id="864" href="V1.AST.html#864" class="InductiveConstructor">program</a>
  <a id="874" class="Keyword">field</a>
    <a id="Program.theMain"></a><a id="884" href="V1.AST.html#884" class="Field">theMain</a>  <a id="893" class="Symbol">:</a> <a id="895" href="V1.AST.html#494" class="Datatype">Exp</a>
<a id="899" class="Keyword">open</a> <a id="904" href="V1.AST.html#830" class="Module">Program</a> <a id="912" class="Keyword">public</a>

<a id="920" class="Symbol">{-#</a> <a id="924" class="Keyword">COMPILE</a> <a id="932" class="Pragma">GHC</a> <a id="936" href="V1.AST.html#830" class="Record">Program</a> <a id="944" class="Pragma">=</a> <a id="946" class="Pragma">data</a> <a id="951" class="Pragma">Program</a> <a id="959" class="Pragma">(Prg)</a> <a id="965" class="Symbol">#-}</a>

<a id="970" class="Comment">-- Pretty printer</a>

<a id="989" class="Keyword">private</a>
  <a id="999" class="Keyword">postulate</a>
    <a id="printType"></a><a id="1013" href="V1.AST.html#1013" class="Postulate">printType</a>    <a id="1026" class="Symbol">:</a> <a id="1028" href="V1.AST.html#282" class="Datatype">Type</a>    <a id="1036" class="Symbol">→</a> <a id="1038" href="Agda.Builtin.String.html#247" class="Postulate">String</a>
    <a id="printBoolean"></a><a id="1049" href="V1.AST.html#1049" class="Postulate">printBoolean</a> <a id="1062" class="Symbol">:</a> <a id="1064" href="V1.AST.html#384" class="Datatype">Boolean</a> <a id="1072" class="Symbol">→</a> <a id="1074" href="Agda.Builtin.String.html#247" class="Postulate">String</a>
    <a id="printExp"></a><a id="1085" href="V1.AST.html#1085" class="Postulate">printExp</a>     <a id="1098" class="Symbol">:</a> <a id="1100" href="V1.AST.html#494" class="Datatype">Exp</a>     <a id="1108" class="Symbol">→</a> <a id="1110" href="Agda.Builtin.String.html#247" class="Postulate">String</a>
    <a id="printProgram"></a><a id="1121" href="V1.AST.html#1121" class="Postulate">printProgram</a> <a id="1134" class="Symbol">:</a> <a id="1136" href="V1.AST.html#830" class="Record">Program</a> <a id="1144" class="Symbol">→</a> <a id="1146" href="Agda.Builtin.String.html#247" class="Postulate">String</a>

<a id="1154" class="Symbol">{-#</a> <a id="1158" class="Keyword">COMPILE</a> <a id="1166" class="Pragma">GHC</a> <a id="1170" href="V1.AST.html#1013" class="Postulate">printType</a>    <a id="1183" class="Pragma">=</a> <a id="1185" class="Pragma">\</a> <a id="1187" class="Pragma">t</a> <a id="1189" class="Pragma">-&gt;</a> <a id="1192" class="Pragma">Data.Text.pack</a> <a id="1207" class="Pragma">(printTree</a> <a id="1218" class="Pragma">(t</a> <a id="1221" class="Pragma">::</a> <a id="1224" class="Pragma">Type))</a>    <a id="1234" class="Symbol">#-}</a>
<a id="1238" class="Symbol">{-#</a> <a id="1242" class="Keyword">COMPILE</a> <a id="1250" class="Pragma">GHC</a> <a id="1254" href="V1.AST.html#1049" class="Postulate">printBoolean</a> <a id="1267" class="Pragma">=</a> <a id="1269" class="Pragma">\</a> <a id="1271" class="Pragma">b</a> <a id="1273" class="Pragma">-&gt;</a> <a id="1276" class="Pragma">Data.Text.pack</a> <a id="1291" class="Pragma">(printTree</a> <a id="1302" class="Pragma">(b</a> <a id="1305" class="Pragma">::</a> <a id="1308" class="Pragma">Boolean))</a> <a id="1318" class="Symbol">#-}</a>
<a id="1322" class="Symbol">{-#</a> <a id="1326" class="Keyword">COMPILE</a> <a id="1334" class="Pragma">GHC</a> <a id="1338" href="V1.AST.html#1085" class="Postulate">printExp</a>     <a id="1351" class="Pragma">=</a> <a id="1353" class="Pragma">\</a> <a id="1355" class="Pragma">e</a> <a id="1357" class="Pragma">-&gt;</a> <a id="1360" class="Pragma">Data.Text.pack</a> <a id="1375" class="Pragma">(printTree</a> <a id="1386" class="Pragma">(e</a> <a id="1389" class="Pragma">::</a> <a id="1392" class="Pragma">Exp))</a>     <a id="1402" class="Symbol">#-}</a>
<a id="1406" class="Symbol">{-#</a> <a id="1410" class="Keyword">COMPILE</a> <a id="1418" class="Pragma">GHC</a> <a id="1422" href="V1.AST.html#1121" class="Postulate">printProgram</a> <a id="1435" class="Pragma">=</a> <a id="1437" class="Pragma">\</a> <a id="1439" class="Pragma">p</a> <a id="1441" class="Pragma">-&gt;</a> <a id="1444" class="Pragma">Data.Text.pack</a> <a id="1459" class="Pragma">(printTree</a> <a id="1470" class="Pragma">(p</a> <a id="1473" class="Pragma">::</a> <a id="1476" class="Pragma">Program))</a> <a id="1486" class="Symbol">#-}</a>

<a id="1491" class="Keyword">instance</a>
  <a id="PrintType"></a><a id="1502" href="V1.AST.html#1502" class="Function">PrintType</a> <a id="1512" class="Symbol">:</a> <a id="1514" href="Library.Print.html#196" class="Record">Print</a> <a id="1520" href="V1.AST.html#282" class="Datatype">Type</a>
  <a id="1527" href="Library.Print.html#244" class="Field">print</a> <a id="1533" class="Symbol">{{</a><a id="1535" href="V1.AST.html#1502" class="Function">PrintType</a><a id="1544" class="Symbol">}}</a> <a id="1547" class="Symbol">=</a> <a id="1549" href="V1.AST.html#1013" class="Postulate">printType</a>

  <a id="PrintBoolean"></a><a id="1562" href="V1.AST.html#1562" class="Function">PrintBoolean</a> <a id="1575" class="Symbol">:</a> <a id="1577" href="Library.Print.html#196" class="Record">Print</a> <a id="1583" href="V1.AST.html#384" class="Datatype">Boolean</a>
  <a id="1593" href="Library.Print.html#244" class="Field">print</a> <a id="1599" class="Symbol">{{</a><a id="1601" href="V1.AST.html#1562" class="Function">PrintBoolean</a><a id="1613" class="Symbol">}}</a> <a id="1616" class="Symbol">=</a> <a id="1618" href="V1.AST.html#1049" class="Postulate">printBoolean</a>

  <a id="PrintExp"></a><a id="1634" href="V1.AST.html#1634" class="Function">PrintExp</a> <a id="1643" class="Symbol">:</a> <a id="1645" href="Library.Print.html#196" class="Record">Print</a> <a id="1651" href="V1.AST.html#494" class="Datatype">Exp</a>
  <a id="1657" href="Library.Print.html#244" class="Field">print</a> <a id="1663" class="Symbol">{{</a><a id="1665" href="V1.AST.html#1634" class="Function">PrintExp</a><a id="1673" class="Symbol">}}</a> <a id="1676" class="Symbol">=</a> <a id="1678" href="V1.AST.html#1085" class="Postulate">printExp</a>

  <a id="PrintProgram"></a><a id="1690" href="V1.AST.html#1690" class="Function">PrintProgram</a> <a id="1703" class="Symbol">:</a> <a id="1705" href="Library.Print.html#196" class="Record">Print</a> <a id="1711" href="V1.AST.html#830" class="Record">Program</a>
  <a id="1721" href="Library.Print.html#244" class="Field">print</a> <a id="1727" class="Symbol">{{</a><a id="1729" href="V1.AST.html#1690" class="Function">PrintProgram</a><a id="1741" class="Symbol">}}</a> <a id="1744" class="Symbol">=</a> <a id="1746" href="V1.AST.html#1121" class="Postulate">printProgram</a>

<a id="1760" class="Comment">-- Eq instance</a>

<a id="1776" class="Keyword">instance</a>
  <a id="EqType"></a><a id="1787" href="V1.AST.html#1787" class="Function">EqType</a> <a id="1794" class="Symbol">:</a> <a id="1796" href="Library.Eq.html#582" class="Record">Eq</a> <a id="1799" href="V1.AST.html#282" class="Datatype">Type</a>
  <a id="1806" href="Library.Eq.html#627" class="Field Operator">_≟_</a> <a id="1810" class="Symbol">{{</a><a id="1812" href="V1.AST.html#1787" class="Function">EqType</a><a id="1818" class="Symbol">}}</a> <a id="1821" class="Symbol">=</a> <a id="1823" class="Symbol">λ</a> <a id="1825" class="Keyword">where</a>
    <a id="1835" href="V1.AST.html#301" class="InductiveConstructor">bool</a> <a id="1840" href="V1.AST.html#301" class="InductiveConstructor">bool</a> <a id="1845" class="Symbol">→</a> <a id="1847" href="Relation.Nullary.html#641" class="InductiveConstructor">yes</a> <a id="1851" href="Agda.Builtin.Equality.html#182" class="InductiveConstructor">refl</a>
    <a id="1860" href="V1.AST.html#301" class="InductiveConstructor">bool</a> <a id="1865" href="V1.AST.html#306" class="InductiveConstructor">int</a>  <a id="1870" class="Symbol">→</a> <a id="1872" href="Relation.Nullary.html#668" class="InductiveConstructor">no</a> <a id="1875" class="Symbol">λ</a> <a id="1877" class="Symbol">()</a>
    <a id="1884" href="V1.AST.html#306" class="InductiveConstructor">int</a>  <a id="1889" href="V1.AST.html#301" class="InductiveConstructor">bool</a> <a id="1894" class="Symbol">→</a> <a id="1896" href="Relation.Nullary.html#668" class="InductiveConstructor">no</a> <a id="1899" class="Symbol">λ</a> <a id="1901" class="Symbol">()</a>
    <a id="1908" href="V1.AST.html#306" class="InductiveConstructor">int</a>  <a id="1913" href="V1.AST.html#306" class="InductiveConstructor">int</a>  <a id="1918" class="Symbol">→</a> <a id="1920" href="Relation.Nullary.html#641" class="InductiveConstructor">yes</a> <a id="1924" href="Agda.Builtin.Equality.html#182" class="InductiveConstructor">refl</a>
</pre></body></html>