<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>V1.AST</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Comment">-- Agda definition of C-- abstract syntax trees</a>
<a id="49" class="Comment">-- and Haskell bindings to the ones generated by the parser.</a>

<a id="111" class="Keyword">module</a> <a id="118" href="V1.AST.html" class="Module">V1.AST</a> <a id="125" class="Keyword">where</a>

<a id="132" class="Keyword">open</a> <a id="137" class="Keyword">import</a> <a id="144" href="Library.html" class="Module">Library</a>

<a id="153" class="Symbol">{-#</a> <a id="157" class="Keyword">FOREIGN</a> <a id="165" class="Pragma">GHC</a> <a id="169" class="Pragma">import</a> <a id="176" class="Pragma">qualified</a> <a id="186" class="Pragma">Data.Text</a> <a id="196" class="Symbol">#-}</a>
<a id="200" class="Symbol">{-#</a> <a id="204" class="Keyword">FOREIGN</a> <a id="212" class="Pragma">GHC</a> <a id="216" class="Pragma">import</a> <a id="223" class="Pragma">While.Abs</a> <a id="233" class="Symbol">#-}</a>
<a id="237" class="Symbol">{-#</a> <a id="241" class="Keyword">FOREIGN</a> <a id="249" class="Pragma">GHC</a> <a id="253" class="Pragma">import</a> <a id="260" class="Pragma">While.Print</a> <a id="272" class="Symbol">#-}</a>

<a id="277" class="Keyword">data</a> <a id="Type"></a><a id="282" href="V1.AST.html#282" class="Datatype">Type</a> <a id="287" class="Symbol">:</a> <a id="289" class="PrimitiveType">Set</a> <a id="293" class="Keyword">where</a>
  <a id="Type.bool"></a><a id="301" href="V1.AST.html#301" class="InductiveConstructor">bool</a> <a id="Type.int"></a><a id="306" href="V1.AST.html#306" class="InductiveConstructor">int</a> <a id="310" class="Symbol">:</a> <a id="312" href="V1.AST.html#282" class="Datatype">Type</a>

<a id="318" class="Symbol">{-#</a> <a id="322" class="Keyword">COMPILE</a> <a id="330" class="Pragma">GHC</a> <a id="334" href="V1.AST.html#282" class="Datatype">Type</a> <a id="339" class="Pragma">=</a> <a id="341" class="Pragma">data</a> <a id="346" class="Pragma">Type</a>
  <a id="353" class="Pragma">(</a> <a id="355" class="Pragma">TBool</a>
  <a id="363" class="Pragma">|</a> <a id="365" class="Pragma">TInt</a>
  <a id="372" class="Pragma">)</a> <a id="374" class="Symbol">#-}</a>

<a id="379" class="Keyword">data</a> <a id="Boolean"></a><a id="384" href="V1.AST.html#384" class="Datatype">Boolean</a> <a id="392" class="Symbol">:</a> <a id="394" class="PrimitiveType">Set</a> <a id="398" class="Keyword">where</a>
  <a id="Boolean.true"></a><a id="406" href="V1.AST.html#406" class="InductiveConstructor">true</a> <a id="Boolean.false"></a><a id="411" href="V1.AST.html#411" class="InductiveConstructor">false</a> <a id="417" class="Symbol">:</a> <a id="419" href="V1.AST.html#384" class="Datatype">Boolean</a>

<a id="428" class="Symbol">{-#</a> <a id="432" class="Keyword">COMPILE</a> <a id="440" class="Pragma">GHC</a> <a id="444" href="V1.AST.html#384" class="Datatype">Boolean</a> <a id="452" class="Pragma">=</a> <a id="454" class="Pragma">data</a> <a id="459" class="Pragma">Boolean</a> <a id="467" class="Pragma">(BTrue</a> <a id="474" class="Pragma">|</a> <a id="476" class="Pragma">BFalse)</a> <a id="484" class="Symbol">#-}</a>

<a id="489" class="Keyword">data</a> <a id="Exp"></a><a id="494" href="V1.AST.html#494" class="Datatype">Exp</a> <a id="498" class="Symbol">:</a> <a id="500" class="PrimitiveType">Set</a> <a id="504" class="Keyword">where</a>
  <a id="Exp.eInt"></a><a id="512" href="V1.AST.html#512" class="InductiveConstructor">eInt</a>   <a id="519" class="Symbol">:</a> <a id="521" class="Symbol">(</a><a id="522" href="V1.AST.html#522" class="Bound">i</a> <a id="524" class="Symbol">:</a> <a id="526" href="Agda.Builtin.Int.html#219" class="Datatype">ℤ</a><a id="527" class="Symbol">)</a>          <a id="538" class="Symbol">→</a> <a id="540" href="V1.AST.html#494" class="Datatype">Exp</a>
  <a id="Exp.eBool"></a><a id="546" href="V1.AST.html#546" class="InductiveConstructor">eBool</a>  <a id="553" class="Symbol">:</a> <a id="555" class="Symbol">(</a><a id="556" href="V1.AST.html#556" class="Bound">b</a> <a id="558" class="Symbol">:</a> <a id="560" href="V1.AST.html#384" class="Datatype">Boolean</a><a id="567" class="Symbol">)</a>    <a id="572" class="Symbol">→</a> <a id="574" href="V1.AST.html#494" class="Datatype">Exp</a>
  <a id="Exp.ePlus"></a><a id="580" href="V1.AST.html#580" class="InductiveConstructor">ePlus</a>  <a id="587" class="Symbol">:</a> <a id="589" class="Symbol">(</a><a id="590" href="V1.AST.html#590" class="Bound">e</a> <a id="592" href="V1.AST.html#592" class="Bound">e&#39;</a> <a id="595" class="Symbol">:</a> <a id="597" href="V1.AST.html#494" class="Datatype">Exp</a><a id="600" class="Symbol">)</a>     <a id="606" class="Symbol">→</a> <a id="608" href="V1.AST.html#494" class="Datatype">Exp</a>
  <a id="Exp.eGt"></a><a id="614" href="V1.AST.html#614" class="InductiveConstructor">eGt</a>    <a id="621" class="Symbol">:</a> <a id="623" class="Symbol">(</a><a id="624" href="V1.AST.html#624" class="Bound">e</a> <a id="626" href="V1.AST.html#626" class="Bound">e&#39;</a> <a id="629" class="Symbol">:</a> <a id="631" href="V1.AST.html#494" class="Datatype">Exp</a><a id="634" class="Symbol">)</a>     <a id="640" class="Symbol">→</a> <a id="642" href="V1.AST.html#494" class="Datatype">Exp</a>
  <a id="Exp.eAnd"></a><a id="648" href="V1.AST.html#648" class="InductiveConstructor">eAnd</a>   <a id="655" class="Symbol">:</a> <a id="657" class="Symbol">(</a><a id="658" href="V1.AST.html#658" class="Bound">e</a> <a id="660" href="V1.AST.html#660" class="Bound">e&#39;</a> <a id="663" class="Symbol">:</a> <a id="665" href="V1.AST.html#494" class="Datatype">Exp</a><a id="668" class="Symbol">)</a>     <a id="674" class="Symbol">→</a> <a id="676" href="V1.AST.html#494" class="Datatype">Exp</a>

<a id="681" class="Symbol">{-#</a> <a id="685" class="Keyword">COMPILE</a> <a id="693" class="Pragma">GHC</a> <a id="697" href="V1.AST.html#494" class="Datatype">Exp</a> <a id="701" class="Pragma">=</a> <a id="703" class="Pragma">data</a> <a id="708" class="Pragma">Exp</a>
  <a id="714" class="Pragma">(</a> <a id="716" class="Pragma">EInt</a>
  <a id="723" class="Pragma">|</a> <a id="725" class="Pragma">EBool</a>
  <a id="733" class="Pragma">|</a> <a id="735" class="Pragma">EPlus</a>
  <a id="743" class="Pragma">|</a> <a id="745" class="Pragma">EGt</a>
  <a id="751" class="Pragma">|</a> <a id="753" class="Pragma">EAnd</a>
  <a id="760" class="Pragma">|</a> <a id="762" class="Pragma">ECond</a>
  <a id="770" class="Pragma">)</a> <a id="772" class="Symbol">#-}</a>

<a id="777" class="Keyword">record</a> <a id="Program"></a><a id="784" href="V1.AST.html#784" class="Record">Program</a> <a id="792" class="Symbol">:</a> <a id="794" class="PrimitiveType">Set</a> <a id="798" class="Keyword">where</a>
  <a id="806" class="Keyword">constructor</a> <a id="Program.program"></a><a id="818" href="V1.AST.html#818" class="InductiveConstructor">program</a>
  <a id="828" class="Keyword">field</a>
    <a id="Program.theMain"></a><a id="838" href="V1.AST.html#838" class="Field">theMain</a>  <a id="847" class="Symbol">:</a> <a id="849" href="V1.AST.html#494" class="Datatype">Exp</a>
<a id="853" class="Keyword">open</a> <a id="858" href="V1.AST.html#784" class="Module">Program</a> <a id="866" class="Keyword">public</a>

<a id="874" class="Symbol">{-#</a> <a id="878" class="Keyword">COMPILE</a> <a id="886" class="Pragma">GHC</a> <a id="890" href="V1.AST.html#784" class="Record">Program</a> <a id="898" class="Pragma">=</a> <a id="900" class="Pragma">data</a> <a id="905" class="Pragma">Program</a> <a id="913" class="Pragma">(Prg)</a> <a id="919" class="Symbol">#-}</a>

<a id="924" class="Comment">-- Pretty printer</a>

<a id="943" class="Keyword">private</a>
  <a id="953" class="Keyword">postulate</a>
    <a id="printType"></a><a id="967" href="V1.AST.html#967" class="Postulate">printType</a>    <a id="980" class="Symbol">:</a> <a id="982" href="V1.AST.html#282" class="Datatype">Type</a>    <a id="990" class="Symbol">→</a> <a id="992" href="Agda.Builtin.String.html#247" class="Postulate">String</a>
    <a id="printBoolean"></a><a id="1003" href="V1.AST.html#1003" class="Postulate">printBoolean</a> <a id="1016" class="Symbol">:</a> <a id="1018" href="V1.AST.html#384" class="Datatype">Boolean</a> <a id="1026" class="Symbol">→</a> <a id="1028" href="Agda.Builtin.String.html#247" class="Postulate">String</a>
    <a id="printExp"></a><a id="1039" href="V1.AST.html#1039" class="Postulate">printExp</a>     <a id="1052" class="Symbol">:</a> <a id="1054" href="V1.AST.html#494" class="Datatype">Exp</a>     <a id="1062" class="Symbol">→</a> <a id="1064" href="Agda.Builtin.String.html#247" class="Postulate">String</a>
    <a id="printProgram"></a><a id="1075" href="V1.AST.html#1075" class="Postulate">printProgram</a> <a id="1088" class="Symbol">:</a> <a id="1090" href="V1.AST.html#784" class="Record">Program</a> <a id="1098" class="Symbol">→</a> <a id="1100" href="Agda.Builtin.String.html#247" class="Postulate">String</a>

<a id="1108" class="Symbol">{-#</a> <a id="1112" class="Keyword">COMPILE</a> <a id="1120" class="Pragma">GHC</a> <a id="1124" href="V1.AST.html#967" class="Postulate">printType</a>    <a id="1137" class="Pragma">=</a> <a id="1139" class="Pragma">\</a> <a id="1141" class="Pragma">t</a> <a id="1143" class="Pragma">-&gt;</a> <a id="1146" class="Pragma">Data.Text.pack</a> <a id="1161" class="Pragma">(printTree</a> <a id="1172" class="Pragma">(t</a> <a id="1175" class="Pragma">::</a> <a id="1178" class="Pragma">Type))</a>    <a id="1188" class="Symbol">#-}</a>
<a id="1192" class="Symbol">{-#</a> <a id="1196" class="Keyword">COMPILE</a> <a id="1204" class="Pragma">GHC</a> <a id="1208" href="V1.AST.html#1003" class="Postulate">printBoolean</a> <a id="1221" class="Pragma">=</a> <a id="1223" class="Pragma">\</a> <a id="1225" class="Pragma">b</a> <a id="1227" class="Pragma">-&gt;</a> <a id="1230" class="Pragma">Data.Text.pack</a> <a id="1245" class="Pragma">(printTree</a> <a id="1256" class="Pragma">(b</a> <a id="1259" class="Pragma">::</a> <a id="1262" class="Pragma">Boolean))</a> <a id="1272" class="Symbol">#-}</a>
<a id="1276" class="Symbol">{-#</a> <a id="1280" class="Keyword">COMPILE</a> <a id="1288" class="Pragma">GHC</a> <a id="1292" href="V1.AST.html#1039" class="Postulate">printExp</a>     <a id="1305" class="Pragma">=</a> <a id="1307" class="Pragma">\</a> <a id="1309" class="Pragma">e</a> <a id="1311" class="Pragma">-&gt;</a> <a id="1314" class="Pragma">Data.Text.pack</a> <a id="1329" class="Pragma">(printTree</a> <a id="1340" class="Pragma">(e</a> <a id="1343" class="Pragma">::</a> <a id="1346" class="Pragma">Exp))</a>     <a id="1356" class="Symbol">#-}</a>
<a id="1360" class="Symbol">{-#</a> <a id="1364" class="Keyword">COMPILE</a> <a id="1372" class="Pragma">GHC</a> <a id="1376" href="V1.AST.html#1075" class="Postulate">printProgram</a> <a id="1389" class="Pragma">=</a> <a id="1391" class="Pragma">\</a> <a id="1393" class="Pragma">p</a> <a id="1395" class="Pragma">-&gt;</a> <a id="1398" class="Pragma">Data.Text.pack</a> <a id="1413" class="Pragma">(printTree</a> <a id="1424" class="Pragma">(p</a> <a id="1427" class="Pragma">::</a> <a id="1430" class="Pragma">Program))</a> <a id="1440" class="Symbol">#-}</a>

<a id="1445" class="Keyword">instance</a>
  <a id="PrintType"></a><a id="1456" href="V1.AST.html#1456" class="Function">PrintType</a> <a id="1466" class="Symbol">:</a> <a id="1468" href="Library.Print.html#196" class="Record">Print</a> <a id="1474" href="V1.AST.html#282" class="Datatype">Type</a>
  <a id="1481" href="Library.Print.html#244" class="Field">print</a> <a id="1487" class="Symbol">{{</a><a id="1489" href="V1.AST.html#1456" class="Function">PrintType</a><a id="1498" class="Symbol">}}</a> <a id="1501" class="Symbol">=</a> <a id="1503" href="V1.AST.html#967" class="Postulate">printType</a>

  <a id="PrintBoolean"></a><a id="1516" href="V1.AST.html#1516" class="Function">PrintBoolean</a> <a id="1529" class="Symbol">:</a> <a id="1531" href="Library.Print.html#196" class="Record">Print</a> <a id="1537" href="V1.AST.html#384" class="Datatype">Boolean</a>
  <a id="1547" href="Library.Print.html#244" class="Field">print</a> <a id="1553" class="Symbol">{{</a><a id="1555" href="V1.AST.html#1516" class="Function">PrintBoolean</a><a id="1567" class="Symbol">}}</a> <a id="1570" class="Symbol">=</a> <a id="1572" href="V1.AST.html#1003" class="Postulate">printBoolean</a>

  <a id="PrintExp"></a><a id="1588" href="V1.AST.html#1588" class="Function">PrintExp</a> <a id="1597" class="Symbol">:</a> <a id="1599" href="Library.Print.html#196" class="Record">Print</a> <a id="1605" href="V1.AST.html#494" class="Datatype">Exp</a>
  <a id="1611" href="Library.Print.html#244" class="Field">print</a> <a id="1617" class="Symbol">{{</a><a id="1619" href="V1.AST.html#1588" class="Function">PrintExp</a><a id="1627" class="Symbol">}}</a> <a id="1630" class="Symbol">=</a> <a id="1632" href="V1.AST.html#1039" class="Postulate">printExp</a>

  <a id="PrintProgram"></a><a id="1644" href="V1.AST.html#1644" class="Function">PrintProgram</a> <a id="1657" class="Symbol">:</a> <a id="1659" href="Library.Print.html#196" class="Record">Print</a> <a id="1665" href="V1.AST.html#784" class="Record">Program</a>
  <a id="1675" href="Library.Print.html#244" class="Field">print</a> <a id="1681" class="Symbol">{{</a><a id="1683" href="V1.AST.html#1644" class="Function">PrintProgram</a><a id="1695" class="Symbol">}}</a> <a id="1698" class="Symbol">=</a> <a id="1700" href="V1.AST.html#1075" class="Postulate">printProgram</a>

<a id="1714" class="Comment">-- Eq instance</a>

<a id="1730" class="Keyword">instance</a>
  <a id="EqType"></a><a id="1741" href="V1.AST.html#1741" class="Function">EqType</a> <a id="1748" class="Symbol">:</a> <a id="1750" href="Library.Eq.html#582" class="Record">Eq</a> <a id="1753" href="V1.AST.html#282" class="Datatype">Type</a>
  <a id="1760" href="Library.Eq.html#627" class="Field Operator">_≟_</a> <a id="1764" class="Symbol">{{</a><a id="1766" href="V1.AST.html#1741" class="Function">EqType</a><a id="1772" class="Symbol">}}</a> <a id="1775" class="Symbol">=</a> <a id="1777" class="Symbol">λ</a> <a id="1779" class="Keyword">where</a>
    <a id="1789" href="V1.AST.html#301" class="InductiveConstructor">bool</a> <a id="1794" href="V1.AST.html#301" class="InductiveConstructor">bool</a> <a id="1799" class="Symbol">→</a> <a id="1801" href="Relation.Nullary.html#641" class="InductiveConstructor">yes</a> <a id="1805" href="Agda.Builtin.Equality.html#182" class="InductiveConstructor">refl</a>
    <a id="1814" href="V1.AST.html#301" class="InductiveConstructor">bool</a> <a id="1819" href="V1.AST.html#306" class="InductiveConstructor">int</a>  <a id="1824" class="Symbol">→</a> <a id="1826" href="Relation.Nullary.html#668" class="InductiveConstructor">no</a> <a id="1829" class="Symbol">λ</a> <a id="1831" class="Symbol">()</a>
    <a id="1838" href="V1.AST.html#306" class="InductiveConstructor">int</a>  <a id="1843" href="V1.AST.html#301" class="InductiveConstructor">bool</a> <a id="1848" class="Symbol">→</a> <a id="1850" href="Relation.Nullary.html#668" class="InductiveConstructor">no</a> <a id="1853" class="Symbol">λ</a> <a id="1855" class="Symbol">()</a>
    <a id="1862" href="V1.AST.html#306" class="InductiveConstructor">int</a>  <a id="1867" href="V1.AST.html#306" class="InductiveConstructor">int</a>  <a id="1872" class="Symbol">→</a> <a id="1874" href="Relation.Nullary.html#641" class="InductiveConstructor">yes</a> <a id="1878" href="Agda.Builtin.Equality.html#182" class="InductiveConstructor">refl</a>
</pre></body></html>