<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>V1.Interpreter</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Comment">-- Interpreter for WHILE language.</a>

<a id="37" class="Comment">-- As computation is not guaranteed to terminate,</a>
<a id="87" class="Comment">-- execution of statements is placed in the Delay monad.</a>

<a id="145" class="Keyword">module</a> <a id="152" href="V1.Interpreter.html" class="Module">V1.Interpreter</a> <a id="167" class="Keyword">where</a>

<a id="174" class="Keyword">open</a> <a id="179" class="Keyword">import</a> <a id="186" href="Library.html" class="Module">Library</a>
<a id="194" class="Keyword">open</a> <a id="199" class="Keyword">import</a> <a id="206" href="V1.WellTypedSyntax.html" class="Module">V1.WellTypedSyntax</a>
<a id="225" class="Keyword">open</a> <a id="230" class="Keyword">import</a> <a id="237" href="V1.Value.html" class="Module">V1.Value</a>

<a id="247" class="Comment">-- Evaluation of expressions in fixed environment ρ.</a>

<a id="eval"></a><a id="301" href="V1.Interpreter.html#301" class="Function">eval</a> <a id="306" class="Symbol">:</a> <a id="308" class="Symbol">∀{</a><a id="310" href="V1.Interpreter.html#310" class="Bound">t</a><a id="311" class="Symbol">}</a> <a id="313" class="Symbol">(</a><a id="314" href="V1.Interpreter.html#314" class="Bound">e</a> <a id="316" class="Symbol">:</a> <a id="318" href="V1.WellTypedSyntax.html#367" class="Datatype">Exp</a> <a id="322" href="V1.Interpreter.html#310" class="Bound">t</a><a id="323" class="Symbol">)</a> <a id="325" class="Symbol">→</a> <a id="327" href="V1.Value.html#150" class="Function">Val</a> <a id="331" href="V1.Interpreter.html#310" class="Bound">t</a>
<a id="333" href="V1.Interpreter.html#301" class="Function">eval</a> <a id="338" class="Symbol">(</a><a id="339" href="V1.WellTypedSyntax.html#407" class="InductiveConstructor">eInt</a>  <a id="345" href="V1.Interpreter.html#345" class="Bound">i</a><a id="346" class="Symbol">)</a>        <a id="355" class="Symbol">=</a> <a id="357" href="V1.Interpreter.html#345" class="Bound">i</a>
<a id="359" href="V1.Interpreter.html#301" class="Function">eval</a> <a id="364" class="Symbol">(</a><a id="365" href="V1.WellTypedSyntax.html#465" class="InductiveConstructor">eBool</a> <a id="371" href="V1.Interpreter.html#371" class="Bound">b</a><a id="372" class="Symbol">)</a>        <a id="381" class="Symbol">=</a> <a id="383" href="V1.Interpreter.html#371" class="Bound">b</a>
<a id="385" href="V1.Interpreter.html#301" class="Function">eval</a> <a id="390" class="Symbol">(</a><a id="391" href="V1.WellTypedSyntax.html#540" class="InductiveConstructor">eOp</a> <a id="395" href="V1.WellTypedSyntax.html#249" class="InductiveConstructor">plus</a> <a id="400" href="V1.Interpreter.html#400" class="Bound">e₁</a> <a id="403" href="V1.Interpreter.html#403" class="Bound">e₂</a><a id="405" class="Symbol">)</a> <a id="407" class="Symbol">=</a> <a id="409" href="V1.Interpreter.html#301" class="Function">eval</a> <a id="414" href="V1.Interpreter.html#400" class="Bound">e₁</a> <a id="417" href="Data.Integer.Base.html#2950" class="Function Operator">+</a> <a id="419" href="V1.Interpreter.html#301" class="Function">eval</a> <a id="424" href="V1.Interpreter.html#403" class="Bound">e₂</a>
<a id="427" href="V1.Interpreter.html#301" class="Function">eval</a> <a id="432" class="Symbol">(</a><a id="433" href="V1.WellTypedSyntax.html#540" class="InductiveConstructor">eOp</a> <a id="437" href="V1.WellTypedSyntax.html#271" class="InductiveConstructor">gt</a>  <a id="441" href="V1.Interpreter.html#441" class="Bound">e₁</a> <a id="444" href="V1.Interpreter.html#444" class="Bound">e₂</a><a id="446" class="Symbol">)</a>  <a id="449" class="Symbol">=</a> <a id="451" href="V1.Value.html#503" class="Function">iGt</a> <a id="455" class="Symbol">(</a><a id="456" href="V1.Interpreter.html#301" class="Function">eval</a> <a id="461" href="V1.Interpreter.html#441" class="Bound">e₁</a><a id="463" class="Symbol">)</a> <a id="465" class="Symbol">(</a><a id="466" href="V1.Interpreter.html#301" class="Function">eval</a> <a id="471" href="V1.Interpreter.html#444" class="Bound">e₂</a><a id="473" class="Symbol">)</a>
<a id="475" href="V1.Interpreter.html#301" class="Function">eval</a> <a id="480" class="Symbol">(</a><a id="481" href="V1.WellTypedSyntax.html#540" class="InductiveConstructor">eOp</a> <a id="485" href="V1.WellTypedSyntax.html#294" class="InductiveConstructor">and</a> <a id="489" href="V1.Interpreter.html#489" class="Bound">e₁</a> <a id="492" href="V1.Interpreter.html#492" class="Bound">e₂</a><a id="494" class="Symbol">)</a>  <a id="497" class="Symbol">=</a> <a id="499" href="Function.html#3662" class="Function Operator">case</a> <a id="504" href="V1.Interpreter.html#301" class="Function">eval</a> <a id="509" href="V1.Interpreter.html#489" class="Bound">e₁</a> <a id="512" href="Function.html#3662" class="Function Operator">of</a> <a id="515" class="Symbol">λ</a> <a id="517" class="Keyword">where</a>
                          <a id="549" href="V1.AST.html#406" class="InductiveConstructor">true</a>  <a id="555" class="Symbol">→</a> <a id="557" href="V1.Interpreter.html#301" class="Function">eval</a> <a id="562" href="V1.Interpreter.html#492" class="Bound">e₂</a>
                          <a id="591" href="V1.AST.html#411" class="InductiveConstructor">false</a> <a id="597" class="Symbol">→</a> <a id="599" href="V1.AST.html#411" class="InductiveConstructor">false</a>

<a id="606" class="Comment">-- Execution of the program (main loop).</a>

<a id="runProgram"></a><a id="648" href="V1.Interpreter.html#648" class="Function">runProgram</a> <a id="659" class="Symbol">:</a> <a id="661" class="Symbol">(</a><a id="662" href="V1.Interpreter.html#662" class="Bound">prg</a> <a id="666" class="Symbol">:</a> <a id="668" href="V1.WellTypedSyntax.html#654" class="Record">Program</a><a id="675" class="Symbol">)</a> <a id="677" class="Symbol">→</a> <a id="679" href="Agda.Builtin.Int.html#219" class="Datatype">ℤ</a>
<a id="681" href="V1.Interpreter.html#648" class="Function">runProgram</a> <a id="692" class="Symbol">(</a><a id="693" href="V1.WellTypedSyntax.html#688" class="InductiveConstructor">program</a> <a id="701" href="V1.Interpreter.html#701" class="Bound">e</a><a id="702" class="Symbol">)</a> <a id="704" class="Symbol">=</a>
  <a id="708" class="Comment">-- Evaluate the main expression to yield result.</a>
  <a id="759" href="V1.Interpreter.html#301" class="Function">eval</a> <a id="764" href="V1.Interpreter.html#701" class="Bound">e</a>
</pre></body></html>